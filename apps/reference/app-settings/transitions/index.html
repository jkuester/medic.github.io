<!doctype html><html lang=en class=no-js><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=generator content="Hugo 0.71.1"><meta name=ROBOTS content="INDEX, FOLLOW"><link rel="shortcut icon" href=/favicons/favicon.ico><link rel=apple-touch-icon href=/favicons/apple-touch-icon-180x180.png sizes=180x180><link rel=icon type=image/png href=/favicons/favicon-16x16.png sizes=16x16><link rel=icon type=image/png href=/favicons/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/favicons/android-36x36.png sizes=36x36><link rel=icon type=image/png href=/favicons/android-48x48.png sizes=48x48><link rel=icon type=image/png href=/favicons/android-72x72.png sizes=72x72><link rel=icon type=image/png href=/favicons/android-96x96.png sizes=96x96><link rel=icon type=image/png href=/favicons/android-144x144.png sizes=144x144><link rel=icon type=image/png href=/favicons/android-192x192.png sizes=192x192><title>.transitions | Community Health Toolkit</title><meta property="og:title" content=".transitions"><meta property="og:description" content="**Sentinel Transitions**: functions executed when database documents change"><meta property="og:type" content="article"><meta property="og:url" content="https://docs.communityhealthtoolkit.org/apps/reference/app-settings/transitions/"><meta property="article:modified_time" content="2021-06-15T17:20:01+03:00"><meta property="og:site_name" content="Community Health Toolkit"><meta itemprop=name content=".transitions"><meta itemprop=description content="**Sentinel Transitions**: functions executed when database documents change"><meta itemprop=dateModified content="2021-06-15T17:20:01+03:00"><meta itemprop=wordCount content="3560"><meta itemprop=keywords content><meta name=twitter:card content="summary"><meta name=twitter:title content=".transitions"><meta name=twitter:description content="**Sentinel Transitions**: functions executed when database documents change"><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-168418637-1','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><link rel=preload href=/scss/main.min.b49a62ff85f2711d9a7ea2511925db921a52b0a75270b09a9a4021dc2217b498.css as=style><link href=/scss/main.min.b49a62ff85f2711d9a7ea2511925db921a52b0a75270b09a9a4021dc2217b498.css rel=stylesheet integrity><script src=https://code.jquery.com/jquery-3.3.1.min.js integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin=anonymous></script></head><body class=td-page><header><nav class="js-navbar-scroll navbar navbar-expand navbar-dark flex-column flex-md-row td-navbar"><a class=navbar-brand href=/><span class=navbar-logo></span><span class="text-uppercase font-weight-bold">Community Health Toolkit</span></a><div class="td-navbar-nav-scroll ml-md-auto" id=main_navbar><ul class="navbar-nav mt-2 mt-lg-0"><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/apps/reference/><span>Reference</span></a></li></ul></div><div class="navbar-nav d-none d-lg-block"><input type=search class="form-control td-search-input" placeholder="&#xf002 Search this site…" aria-label="Search this site…" autocomplete=off></div></nav></header><div class="container-fluid td-outer"><div class=td-main><div class="row flex-xl-nowrap"><div class="col-12 col-md-3 col-xl-2 td-sidebar d-print-none"><div id=td-sidebar-menu class=td-sidebar__inner><form class="td-sidebar__search d-flex align-items-center"><input type=search class="form-control td-search-input" placeholder="&#xf002 Search this site…" aria-label="Search this site…" autocomplete=off>
<button class="btn btn-link td-sidebar__toggle d-md-none p-0 ml-3 fas fa-bars" type=button data-toggle=collapse data-target=#td-section-nav aria-controls=td-docs-nav aria-expanded=false aria-label="Toggle section navigation"></button></form><nav class="collapse td-sidebar-nav pt-2 pl-4" id=td-section-nav><ul class=td-sidebar-nav__section><a class="td-sidebar-link td-sidebar-link__page" id=m-why-the-cht href=/why-the-cht/>Why the CHT?</a><ul class=td-sidebar-nav__section><li class=td-sidebar-nav__section-title><a href=/apps/ class="align-left pl-0 active td-sidebar-link td-sidebar-link__section">CHT Applications&nbsp;&nbsp;<i class="fas fa-caret-down"></i></a></li><ul><li class="collapse show" id=apps><ul class=td-sidebar-nav__section><li class=td-sidebar-nav__section-title><a href=/apps/concepts/ class="align-left pl-0 collapsed td-sidebar-link td-sidebar-link__section">Concepts&nbsp;&nbsp;<i class="fas fa-caret-right"></i></a></li><ul><li class=collapse id=appsconcepts><a class="td-sidebar-link td-sidebar-link__page" id=m-appsconceptsaccess href=/apps/concepts/access/>Access</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-appsconceptsnavigation href=/apps/concepts/navigation/>Navigation</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-appsconceptsforms href=/apps/concepts/forms/>Forms</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-appsconceptscare-guides href=/apps/concepts/care-guides/>Care Guides</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-appsconceptsworkflows href=/apps/concepts/workflows/>Workflows</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-appsconceptshierarchy href=/apps/concepts/hierarchy/>Hierarchies</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-appsconceptsusers href=/apps/concepts/users/>Users</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-appsconceptsinteroperability href=/apps/concepts/interoperability/>Interoperability</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-appsconceptsprerequisites href=/apps/concepts/prerequisites/>Prerequisites</a></li></ul></ul><ul class=td-sidebar-nav__section><li class=td-sidebar-nav__section-title><a href=/apps/features/ class="align-left pl-0 collapsed td-sidebar-link td-sidebar-link__section">Features&nbsp;&nbsp;<i class="fas fa-caret-right"></i></a></li><ul><li class=collapse id=appsfeatures><ul class=td-sidebar-nav__section><li class=td-sidebar-nav__section-title><a href=/apps/features/contacts/ class="align-left pl-0 collapsed td-sidebar-link td-sidebar-link__section">Contacts&nbsp;&nbsp;<i class="fas fa-caret-right"></i></a></li><ul><li class=collapse id=appsfeaturescontacts></li></ul></ul><ul class=td-sidebar-nav__section><li class=td-sidebar-nav__section-title><a href=/apps/features/messaging/ class="align-left pl-0 collapsed td-sidebar-link td-sidebar-link__section">Messaging&nbsp;&nbsp;<i class="fas fa-caret-right"></i></a></li><ul><li class=collapse id=appsfeaturesmessaging></li></ul></ul><ul class=td-sidebar-nav__section><li class=td-sidebar-nav__section-title><a href=/apps/features/reports/ class="align-left pl-0 collapsed td-sidebar-link td-sidebar-link__section">Reports&nbsp;&nbsp;<i class="fas fa-caret-right"></i></a></li><ul><li class=collapse id=appsfeaturesreports></li></ul></ul><ul class=td-sidebar-nav__section><li class=td-sidebar-nav__section-title><a href=/apps/features/supervision/ class="align-left pl-0 collapsed td-sidebar-link td-sidebar-link__section">Supervision&nbsp;&nbsp;<i class="fas fa-caret-right"></i></a></li><ul><li class=collapse id=appsfeaturessupervision></li></ul></ul><ul class=td-sidebar-nav__section><li class=td-sidebar-nav__section-title><a href=/apps/features/tasks/ class="align-left pl-0 collapsed td-sidebar-link td-sidebar-link__section">Tasks&nbsp;&nbsp;<i class="fas fa-caret-right"></i></a></li><ul><li class=collapse id=appsfeaturestasks></li></ul></ul><ul class=td-sidebar-nav__section><li class=td-sidebar-nav__section-title><a href=/apps/features/targets/ class="align-left pl-0 collapsed td-sidebar-link td-sidebar-link__section">Targets&nbsp;&nbsp;<i class="fas fa-caret-right"></i></a></li><ul><li class=collapse id=appsfeaturestargets></li></ul></ul><ul class=td-sidebar-nav__section><li class=td-sidebar-nav__section-title><a href=/apps/features/uhc-mode/ class="align-left pl-0 collapsed td-sidebar-link td-sidebar-link__section">UHC Mode&nbsp;&nbsp;<i class="fas fa-caret-right"></i></a></li><ul><li class=collapse id=appsfeaturesuhc-mode></li></ul></ul><ul class=td-sidebar-nav__section><li class=td-sidebar-nav__section-title><a href=/apps/features/admin/ class="align-left pl-0 collapsed td-sidebar-link td-sidebar-link__section">App Management&nbsp;&nbsp;<i class="fas fa-caret-right"></i></a></li><ul><li class=collapse id=appsfeaturesadmin></li></ul></ul><ul class=td-sidebar-nav__section><li class=td-sidebar-nav__section-title><a href=/apps/features/integrations/ class="align-left pl-0 collapsed td-sidebar-link td-sidebar-link__section">Integrations&nbsp;&nbsp;<i class="fas fa-caret-right"></i></a></li><ul><li class=collapse id=appsfeaturesintegrations><a class="td-sidebar-link td-sidebar-link__page" id=m-appsfeaturesintegrationsandroid href=/apps/features/integrations/android/>Android</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-appsfeaturesintegrationscustom href=/apps/features/integrations/custom/>Custom</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-appsfeaturesintegrationsdhis2 href=/apps/features/integrations/dhis2/>DHIS2</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-appsfeaturesintegrationsopenmrs href=/apps/features/integrations/openmrs/>OpenMRS</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-appsfeaturesintegrationsoppia href=/apps/features/integrations/oppia/>OppiaMobile</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-appsfeaturesintegrationsrapidpro href=/apps/features/integrations/rapidpro/>RapidPro</a></li></ul></ul></li></ul></ul><ul class=td-sidebar-nav__section><li class=td-sidebar-nav__section-title><a href=/apps/examples/ class="align-left pl-0 collapsed td-sidebar-link td-sidebar-link__section">Examples&nbsp;&nbsp;<i class="fas fa-caret-right"></i></a></li><ul><li class=collapse id=appsexamples><a class="td-sidebar-link td-sidebar-link__page" id=m-appsexamplesanc href=/apps/examples/anc/>Maternal & Newborn Health</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-appsexamplescontact-tracing href=/apps/examples/contact-tracing/>Contact Tracing</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-appsexamplesphc-covid href=/apps/examples/phc-covid/>COVID-19 Adaptations</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-appsexamplescovid-education href=/apps/examples/covid-education/>COVID-19 Education</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-appsexamplescovid-rdt-reference-app href=/apps/examples/covid-rdt-reference-app/>COVID-19 Testing</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-appsexamplesebs href=/apps/examples/ebs/>Event Based Surveillance</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-appsexampleslearning-care href=/apps/examples/learning-care/>Learning & Care</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-appsexamplestraining href=/apps/examples/training/>Remote Training</a></li></ul></ul><ul class=td-sidebar-nav__section><li class=td-sidebar-nav__section-title><a href=/apps/tutorials/ class="align-left pl-0 collapsed td-sidebar-link td-sidebar-link__section">Tutorials&nbsp;&nbsp;<i class="fas fa-caret-right"></i></a></li><ul><li class=collapse id=appstutorials><a class="td-sidebar-link td-sidebar-link__page" id=m-appstutorialslocal-setup href=/apps/tutorials/local-setup/>Local Setup</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-appstutorialscontact-and-users-1 href=/apps/tutorials/contact-and-users-1/>Contacts + Users 1</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-appstutorialscontact-and-users-2 href=/apps/tutorials/contact-and-users-2/>Contacts + Users 2</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-appstutorialsapplication-settings href=/apps/tutorials/application-settings/>Application Settings</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-appstutorialssms-forms href=/apps/tutorials/sms-forms/>SMS Forms</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-appstutorialssms-schedules href=/apps/tutorials/sms-schedules/>SMS Schedules</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-appstutorialsapp-forms href=/apps/tutorials/app-forms/>App Forms</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-appstutorialsform-properties href=/apps/tutorials/form-properties/>Form Properties</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-appstutorialstasks-1 href=/apps/tutorials/tasks-1/>Tasks</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-appstutorialstargets href=/apps/tutorials/targets/>Targets</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-appstutorialscontact-summary href=/apps/tutorials/contact-summary/>Contact Summary</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-appstutorialsdeath-reporting href=/apps/tutorials/death-reporting/>Death Report Workflow</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-appstutorialscondition-cards href=/apps/tutorials/condition-cards/>Condition Cards</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-appstutorialsapplication-graphics href=/apps/tutorials/application-graphics/>Branding</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-appstutorialstasks-2 href=/apps/tutorials/tasks-2/>Complex Tasks</a></li></ul></ul><ul class=td-sidebar-nav__section><li class=td-sidebar-nav__section-title><a href=/apps/guides/ class="align-left pl-0 collapsed td-sidebar-link td-sidebar-link__section">Quick Guides&nbsp;&nbsp;<i class="fas fa-caret-right"></i></a></li><ul><li class=collapse id=appsguides><ul class=td-sidebar-nav__section><li class=td-sidebar-nav__section-title><a href=/apps/guides/data/ class="align-left pl-0 collapsed td-sidebar-link td-sidebar-link__section">Data&nbsp;&nbsp;<i class="fas fa-caret-right"></i></a></li><ul><li class=collapse id=appsguidesdata><a class="td-sidebar-link td-sidebar-link__page" id=m-appsguidesdatahydration href=/apps/guides/data/hydration/>Document hydration</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-appsguidesdatausers-bulk-load href=/apps/guides/data/users-bulk-load/>Bulk Load Users</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-appsguidesdataimpact-metrics href=/apps/guides/data/impact-metrics/>CHT Impact Metrics</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-appsguidesdatacsv-to-docs href=/apps/guides/data/csv-to-docs/>CSV to Docs</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-appsguidesdatainvalid-reports href=/apps/guides/data/invalid-reports/>Invalid Reports</a></li></ul></ul><ul class=td-sidebar-nav__section><li class=td-sidebar-nav__section-title><a href=/apps/guides/database/ class="align-left pl-0 collapsed td-sidebar-link td-sidebar-link__section">Database&nbsp;&nbsp;<i class="fas fa-caret-right"></i></a></li><ul><li class=collapse id=appsguidesdatabase><a class="td-sidebar-link td-sidebar-link__page" id=m-appsguidesdatabasemuting_in_dashboards href=/apps/guides/database/muting_in_dashboards/>Contact Muting in SQL queries</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-appsguidesdatabasecouch2pg-oom-errors href=/apps/guides/database/couch2pg-oom-errors/>Couch2pg Memory Errors</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-appsguidesdatabasecouchdb-authentication href=/apps/guides/database/couchdb-authentication/>CouchDB Authentication</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-appsguidesdatabasedatabase-conflicts href=/apps/guides/database/database-conflicts/>Database Conflicts</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-appsguidesdatabaserdbms-from-mac href=/apps/guides/database/rdbms-from-mac/>RDBMS from MacOS</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-appsguidesdatabaserdbms-from-windows href=/apps/guides/database/rdbms-from-windows/>RDBMS from Windows</a></li></ul></ul><ul class=td-sidebar-nav__section><li class=td-sidebar-nav__section-title><a href=/apps/guides/debugging/ class="align-left pl-0 collapsed td-sidebar-link td-sidebar-link__section">Debugging&nbsp;&nbsp;<i class="fas fa-caret-right"></i></a></li><ul><li class=collapse id=appsguidesdebugging><a class="td-sidebar-link td-sidebar-link__page" id=m-appsguidesdebuggingobtaining-logs href=/apps/guides/debugging/obtaining-logs/>Obtaining Logs</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-appsguidesdebuggingreplicating-production-data-locally href=/apps/guides/debugging/replicating-production-data-locally/>Production Data</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-appsguidesdebuggingsecure-sharing-of-developer-instance href=/apps/guides/debugging/secure-sharing-of-developer-instance/>Securely Sharing Your Development Environment</a></li></ul></ul><ul class=td-sidebar-nav__section><li class=td-sidebar-nav__section-title><a href=/apps/guides/forms/ class="align-left pl-0 collapsed td-sidebar-link td-sidebar-link__section">Forms&nbsp;&nbsp;<i class="fas fa-caret-right"></i></a></li><ul><li class=collapse id=appsguidesforms><a class="td-sidebar-link td-sidebar-link__page" id=m-appsguidesformsuhc-mode href=/apps/guides/forms/uhc-mode/>UHC Mode</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-appsguidesformsadditional-docs href=/apps/guides/forms/additional-docs/>Additional Docs</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-appsguidesformsapp-form-sms href=/apps/guides/forms/app-form-sms/>App Form SMS</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-appsguidesformscontact-forms href=/apps/guides/forms/contact-forms/>Contact Forms</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-appsguidesformsgoogle-drive href=/apps/guides/forms/google-drive/>Fetching forms from Google Drive</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-appsguidesformsmultimedia href=/apps/guides/forms/multimedia/>Multimedia in Forms</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-appsguidesformswealth-quintiles href=/apps/guides/forms/wealth-quintiles/>Quintiles</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-appsguidesformsreport-titles href=/apps/guides/forms/report-titles/>Report Titles</a></li></ul></ul><ul class=td-sidebar-nav__section><li class=td-sidebar-nav__section-title><a href=/apps/guides/hosting/ class="align-left pl-0 collapsed td-sidebar-link td-sidebar-link__section">Hosting&nbsp;&nbsp;<i class="fas fa-caret-right"></i></a></li><ul><li class=collapse id=appsguideshosting><a class="td-sidebar-link td-sidebar-link__page" id=m-appsguideshostingrequirements href=/apps/guides/hosting/requirements/>Requirements</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-appsguideshostingec2-setup-guide href=/apps/guides/hosting/ec2-setup-guide/>AWS Hosting</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-appsguideshostingself-hosting href=/apps/guides/hosting/self-hosting/>Self Hosting</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-appsguideshostingapp-developer href=/apps/guides/hosting/app-developer/>App Developer Hosting</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-appsguideshostingssl-cert-install href=/apps/guides/hosting/ssl-cert-install/>SSL Cert Install</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-appsguideshostingoffline href=/apps/guides/hosting/offline/>Offline Hosting</a></li></ul></ul><ul class=td-sidebar-nav__section><li class=td-sidebar-nav__section-title><a href=/apps/guides/integrations/ class="align-left pl-0 collapsed td-sidebar-link td-sidebar-link__section">Integrations&nbsp;&nbsp;<i class="fas fa-caret-right"></i></a></li><ul><li class=collapse id=appsguidesintegrations><ul class=td-sidebar-nav__section><li class=td-sidebar-nav__section-title><a href=/apps/guides/integrations/best-practices/ class="align-left pl-0 collapsed td-sidebar-link td-sidebar-link__section">Best Practices&nbsp;&nbsp;<i class="fas fa-caret-right"></i></a></li><ul><li class=collapse id=appsguidesintegrationsbest-practices><a class="td-sidebar-link td-sidebar-link__page" id=m-appsguidesintegrationsbest-practicesrapidpro href=/apps/guides/integrations/best-practices/rapidpro/>RapidPro</a></li></ul></ul><a class="td-sidebar-link td-sidebar-link__page" id=m-appsguidesintegrationsdhis2-aggregate href=/apps/guides/integrations/dhis2-aggregate/>DHIS2 Aggregate</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-appsguidesintegrationsopenmrs href=/apps/guides/integrations/openmrs/>OpenMRS</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-appsguidesintegrationsoppia href=/apps/guides/integrations/oppia/>OppiaMobile</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-appsguidesintegrationsrapidpro href=/apps/guides/integrations/rapidpro/>RapidPro</a></li></ul></ul><ul class=td-sidebar-nav__section><li class=td-sidebar-nav__section-title><a href=/apps/guides/messaging/ class="align-left pl-0 collapsed td-sidebar-link td-sidebar-link__section">Messaging&nbsp;&nbsp;<i class="fas fa-caret-right"></i></a></li><ul><li class=collapse id=appsguidesmessaging><ul class=td-sidebar-nav__section><li class=td-sidebar-nav__section-title><a href=/apps/guides/messaging/gateways/ class="align-left pl-0 collapsed td-sidebar-link td-sidebar-link__section">Gateways&nbsp;&nbsp;<i class="fas fa-caret-right"></i></a></li><ul><li class=collapse id=appsguidesmessaginggateways><ul class=td-sidebar-nav__section><li class=td-sidebar-nav__section-title><a href=/apps/guides/messaging/gateways/gateway/ class="align-left pl-0 collapsed td-sidebar-link td-sidebar-link__section">CHT Gateway&nbsp;&nbsp;<i class="fas fa-caret-right"></i></a></li><ul><li class=collapse id=appsguidesmessaginggatewaysgateway><a class="td-sidebar-link td-sidebar-link__page" id=m-appsguidesmessaginggatewaysgatewayconfiguration href=/apps/guides/messaging/gateways/gateway/configuration/>Configuration</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-appsguidesmessaginggatewaysgatewayphones href=/apps/guides/messaging/gateways/gateway/phones/>Phones</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-appsguidesmessaginggatewaysgatewaytroubleshooting href=/apps/guides/messaging/gateways/gateway/troubleshooting/>Troubleshooting</a></li></ul></ul><a class="td-sidebar-link td-sidebar-link__page" id=m-appsguidesmessaginggatewaysafricas-talking href=/apps/guides/messaging/gateways/africas-talking/>Africa's Talking</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-appsguidesmessaginggatewaysrapidpro href=/apps/guides/messaging/gateways/rapidpro/>RapidPro</a></li></ul></ul><a class="td-sidebar-link td-sidebar-link__page" id=m-appsguidesmessagingsms-states href=/apps/guides/messaging/sms-states/>SMS States</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-appsguidesmessagingshortcodes href=/apps/guides/messaging/shortcodes/>Contact IDs</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-appsguidesmessagingmessage-loops href=/apps/guides/messaging/message-loops/>Message Loops</a></li></ul></ul><ul class=td-sidebar-nav__section><li class=td-sidebar-nav__section-title><a href=/apps/guides/performance/ class="align-left pl-0 collapsed td-sidebar-link td-sidebar-link__section">Performance&nbsp;&nbsp;<i class="fas fa-caret-right"></i></a></li><ul><li class=collapse id=appsguidesperformance><a class="td-sidebar-link td-sidebar-link__page" id=m-appsguidesperformancepurging href=/apps/guides/performance/purging/>Purging</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-appsguidesperformancereplication href=/apps/guides/performance/replication/>Replication</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-appsguidesperformancetelemetry href=/apps/guides/performance/telemetry/>Telemetry</a></li></ul></ul><ul class=td-sidebar-nav__section><li class=td-sidebar-nav__section-title><a href=/apps/guides/privacy/ class="align-left pl-0 collapsed td-sidebar-link td-sidebar-link__section">Privacy&nbsp;&nbsp;<i class="fas fa-caret-right"></i></a></li><ul><li class=collapse id=appsguidesprivacy><a class="td-sidebar-link td-sidebar-link__page" id=m-appsguidesprivacyprivacy-policy href=/apps/guides/privacy/privacy-policy/>Adding Policies</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-appsguidesprivacypolicy href=/apps/guides/privacy/policy/>Medic’s Policy</a></li></ul></ul><ul class=td-sidebar-nav__section><li class=td-sidebar-nav__section-title><a href=/apps/guides/security/ class="align-left pl-0 collapsed td-sidebar-link td-sidebar-link__section">Security&nbsp;&nbsp;<i class="fas fa-caret-right"></i></a></li><ul><li class=collapse id=appsguidessecurity><a class="td-sidebar-link td-sidebar-link__page" id=m-appsguidessecuritysecuring-android href=/apps/guides/security/securing-android/>Securing Android</a></li></ul></ul><ul class=td-sidebar-nav__section><li class=td-sidebar-nav__section-title><a href=/apps/guides/tasks/ class="align-left pl-0 collapsed td-sidebar-link td-sidebar-link__section">Tasks&nbsp;&nbsp;<i class="fas fa-caret-right"></i></a></li><ul><li class=collapse id=appsguidestasks><a class="td-sidebar-link td-sidebar-link__page" id=m-appsguidestaskspass-data-to-form href=/apps/guides/tasks/pass-data-to-form/>Passing Data from Tasks to Forms</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-appsguidestasksquery-task-data href=/apps/guides/tasks/query-task-data/>Querying Task Documents</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-appsguidestaskstask-schema-parameters href=/apps/guides/tasks/task-schema-parameters/>Task Schema Parameters</a></li></ul></ul><ul class=td-sidebar-nav__section><li class=td-sidebar-nav__section-title><a href=/apps/guides/updates/ class="align-left pl-0 collapsed td-sidebar-link td-sidebar-link__section">Updates&nbsp;&nbsp;<i class="fas fa-caret-right"></i></a></li><ul><li class=collapse id=appsguidesupdates><a class="td-sidebar-link td-sidebar-link__page" id=m-appsguidesupdatesmoving-contacts href=/apps/guides/updates/moving-contacts/>Moving Contacts</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-appsguidesupdatescollect-forms-update href=/apps/guides/updates/collect-forms-update/>Remote Collect Update</a></li></ul></ul></li></ul></ul><ul class=td-sidebar-nav__section><li class=td-sidebar-nav__section-title><a href=/apps/reference/ class="align-left pl-0 active td-sidebar-link td-sidebar-link__section">Reference&nbsp;&nbsp;<i class="fas fa-caret-down"></i></a></li><ul><li class="collapse show" id=appsreference><a class="td-sidebar-link td-sidebar-link__page" id=m-appsreferenceapi href=/apps/reference/api/>API</a><ul class=td-sidebar-nav__section><li class=td-sidebar-nav__section-title><a href=/apps/reference/forms/ class="align-left pl-0 collapsed td-sidebar-link td-sidebar-link__section">forms/&nbsp;&nbsp;<i class="fas fa-caret-right"></i></a></li><ul><li class=collapse id=appsreferenceforms><a class="td-sidebar-link td-sidebar-link__page" id=m-appsreferenceformsapp href=/apps/reference/forms/app/>app</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-appsreferenceformscollect href=/apps/reference/forms/collect/>collect</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-appsreferenceformscontact href=/apps/reference/forms/contact/>contact</a></li></ul></ul><a class="td-sidebar-link td-sidebar-link__page" id=m-appsreferenceresources href=/apps/reference/resources/>resources/</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-appsreferencetranslations href=/apps/reference/translations/>translations/</a><ul class=td-sidebar-nav__section><li class=td-sidebar-nav__section-title><a href=/apps/reference/app-settings/ class="align-left pl-0 active td-sidebar-link td-sidebar-link__section">app_settings.json&nbsp;&nbsp;<i class="fas fa-caret-down"></i></a></li><ul><li class="collapse show" id=appsreferenceapp-settings><a class="td-sidebar-link td-sidebar-link__page" id=m-appsreferenceapp-settingsaccept_case_reports href=/apps/reference/app-settings/accept_case_reports/>.accept_case_reports</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-appsreferenceapp-settingshierarchy href=/apps/reference/app-settings/hierarchy/>.contact_types</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-appsreferenceapp-settingsdhis2 href=/apps/reference/app-settings/dhis2/>.dhis_data_sets</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-appsreferenceapp-settingsforms href=/apps/reference/app-settings/forms/>.forms</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-appsreferenceapp-settingsheader_tabs href=/apps/reference/app-settings/header_tabs/>.header_tabs</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-appsreferenceapp-settingsoutbound href=/apps/reference/app-settings/outbound/>.outbound</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-appsreferenceapp-settingspatient_reports href=/apps/reference/app-settings/patient_reports/>.patient_reports</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-appsreferenceapp-settingsuser-permissions href=/apps/reference/app-settings/user-permissions/>.permissions</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-appsreferenceapp-settingsregistrations href=/apps/reference/app-settings/registrations/>.registrations</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-appsreferenceapp-settingsreminders href=/apps/reference/app-settings/reminders/>.reminders</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-appsreferenceapp-settingsreplication_depth href=/apps/reference/app-settings/replication_depth/>.replication_depth</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-appsreferenceapp-settingsreplications href=/apps/reference/app-settings/replications/>.replications</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-appsreferenceapp-settingsuser-roles href=/apps/reference/app-settings/user-roles/>.roles</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-appsreferenceapp-settingsschedules href=/apps/reference/app-settings/schedules/>.schedules</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-appsreferenceapp-settingssms href=/apps/reference/app-settings/sms/>.sms</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-appsreferenceapp-settingstoken_login href=/apps/reference/app-settings/token_login/>.token_login</a>
<a class="td-sidebar-link td-sidebar-link__page active" id=m-appsreferenceapp-settingstransitions href=/apps/reference/app-settings/transitions/>.transitions</a></li></ul></ul><a class="td-sidebar-link td-sidebar-link__page" id=m-appsreferencecontact-page href=/apps/reference/contact-page/>contact-summary.templated.js</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-appsreferencetargets href=/apps/reference/targets/>targets.js</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-appsreferencetasks href=/apps/reference/tasks/>tasks.js</a></li></ul></ul></li></ul></ul><ul class=td-sidebar-nav__section><li class=td-sidebar-nav__section-title><a href=/core/ class="align-left pl-0 collapsed td-sidebar-link td-sidebar-link__section">CHT Core Framework&nbsp;&nbsp;<i class="fas fa-caret-right"></i></a></li><ul><li class=collapse id=core><ul class=td-sidebar-nav__section><li class=td-sidebar-nav__section-title><a href=/core/overview/ class="align-left pl-0 collapsed td-sidebar-link td-sidebar-link__section">Overview&nbsp;&nbsp;<i class="fas fa-caret-right"></i></a></li><ul><li class=collapse id=coreoverview><a class="td-sidebar-link td-sidebar-link__page" id=m-coreoverviewarchitecture href=/core/overview/architecture/>Architecture</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-coreoverviewdb-schema href=/core/overview/db-schema/>Database Schema</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-coreoverviewtechnical-roadmap href=/core/overview/technical-roadmap/>Technical Roadmap</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-coreoverviewdata-flows-for-analytics href=/core/overview/data-flows-for-analytics/>Data Flows</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-coreoverviewtransitions href=/core/overview/transitions/>Sentinel Transitions</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-coreoverviewtranslations href=/core/overview/translations/>Translations</a></li></ul></ul><ul class=td-sidebar-nav__section><li class=td-sidebar-nav__section-title><a href=/core/releases/ class="align-left pl-0 collapsed td-sidebar-link td-sidebar-link__section">Releases&nbsp;&nbsp;<i class="fas fa-caret-right"></i></a></li><ul><li class=collapse id=corereleases><a class="td-sidebar-link td-sidebar-link__page" id=m-corereleasesfeature_releases href=/core/releases/feature_releases/>Feature Releases</a></li></ul></ul><ul class=td-sidebar-nav__section><li class=td-sidebar-nav__section-title><a href=/core/guides/ class="align-left pl-0 collapsed td-sidebar-link td-sidebar-link__section">Guides&nbsp;&nbsp;<i class="fas fa-caret-right"></i></a></li><ul><li class=collapse id=coreguides><a class="td-sidebar-link td-sidebar-link__page" id=m-coreguidesreleasing href=/core/guides/releasing/>Releasing</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-coreguidesupdate-dependencies href=/core/guides/update-dependencies/>Dependencies</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-coreguidesfixing-e2e-tests href=/core/guides/fixing-e2e-tests/>E2E Tests</a><ul class=td-sidebar-nav__section><li class=td-sidebar-nav__section-title><a href=/core/guides/android/ class="align-left pl-0 collapsed td-sidebar-link td-sidebar-link__section">Android&nbsp;&nbsp;<i class="fas fa-caret-right"></i></a></li><ul><li class=collapse id=coreguidesandroid><a class="td-sidebar-link td-sidebar-link__page" id=m-coreguidesandroiddevelopment-setup href=/core/guides/android/development-setup/>Development Environment</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-coreguidesandroidreleasing href=/core/guides/android/releasing/>Releasing</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-coreguidesandroidpublishing href=/core/guides/android/publishing/>Publishing</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-coreguidesandroidbranding href=/core/guides/android/branding/>CHT Android Flavors</a></li></ul></ul><a class="td-sidebar-link td-sidebar-link__page" id=m-coreguidesusing-git href=/core/guides/using-git/>Using Git</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-coreguidesusing-npm href=/core/guides/using-npm/>Using NPM</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-coreguidesusing-windows href=/core/guides/using-windows/>Windows Development</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-coreguidesdocker-setup href=/core/guides/docker-setup/>Docker Use</a></li></ul></ul></li></ul></ul><ul class=td-sidebar-nav__section><li class=td-sidebar-nav__section-title><a href=/design/ class="align-left pl-0 collapsed td-sidebar-link td-sidebar-link__section">Design System&nbsp;&nbsp;<i class="fas fa-caret-right"></i></a></li><ul><li class=collapse id=design><ul class=td-sidebar-nav__section><li class=td-sidebar-nav__section-title><a href=/design/personas/ class="align-left pl-0 collapsed td-sidebar-link td-sidebar-link__section">Personas&nbsp;&nbsp;<i class="fas fa-caret-right"></i></a></li><ul><li class=collapse id=designpersonas><a class="td-sidebar-link td-sidebar-link__page" id=m-designpersonaschw-janet href=/design/personas/chw-janet/>CHW</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-designpersonaschw-supervisor-ann href=/design/personas/chw-supervisor-ann/>CHW Supervisor</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-designpersonasregional-manager-christina href=/design/personas/regional-manager-christina/>Regional Manager</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-designpersonasnurse-mary href=/design/personas/nurse-mary/>Nurse</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-designpersonasdata-manager-paul href=/design/personas/data-manager-paul/>Data Manager</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-designpersonasapp-builder href=/design/personas/app-builder/>App Builders</a><ul class=td-sidebar-nav__section><li class=td-sidebar-nav__section-title><a href=/design/personas/partners/ class="align-left pl-0 collapsed td-sidebar-link td-sidebar-link__section">Partners&nbsp;&nbsp;<i class="fas fa-caret-right"></i></a></li><ul><li class=collapse id=designpersonaspartners><a class="td-sidebar-link td-sidebar-link__page" id=m-designpersonaspartnersimplementers href=/design/personas/partners/implementers/>Implementers</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-designpersonaspartnerslocal-governments href=/design/personas/partners/local-governments/>Local Gov</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-designpersonaspartnersnational-governments href=/design/personas/partners/national-governments/>National Gov</a></li></ul></ul></li></ul></ul><ul class=td-sidebar-nav__section><li class=td-sidebar-nav__section-title><a href=/design/best-practices/ class="align-left pl-0 collapsed td-sidebar-link td-sidebar-link__section">Best Practices&nbsp;&nbsp;<i class="fas fa-caret-right"></i></a></li><ul><li class=collapse id=designbest-practices></li></ul></ul><ul class=td-sidebar-nav__section><li class=td-sidebar-nav__section-title><a href=/design/components/ class="align-left pl-0 collapsed td-sidebar-link td-sidebar-link__section">Component Library&nbsp;&nbsp;<i class="fas fa-caret-right"></i></a></li><ul><li class=collapse id=designcomponents></li></ul></ul><ul class=td-sidebar-nav__section><li class=td-sidebar-nav__section-title><a href=/design/icons/ class="align-left pl-0 collapsed td-sidebar-link td-sidebar-link__section">Icon Library&nbsp;&nbsp;<i class="fas fa-caret-right"></i></a></li><ul><li class=collapse id=designicons><ul class=td-sidebar-nav__section><li class=td-sidebar-nav__section-title><a href=/design/icons/forms_tasks_targets/ class="align-left pl-0 collapsed td-sidebar-link td-sidebar-link__section">Forms, Tasks, Targets&nbsp;&nbsp;<i class="fas fa-caret-right"></i></a></li><ul><li class=collapse id=designiconsforms_tasks_targets></li></ul></ul><ul class=td-sidebar-nav__section><li class=td-sidebar-nav__section-title><a href=/design/icons/people_and_places/ class="align-left pl-0 collapsed td-sidebar-link td-sidebar-link__section">People and Places&nbsp;&nbsp;<i class="fas fa-caret-right"></i></a></li><ul><li class=collapse id=designiconspeople_and_places></li></ul></ul></li></ul></ul><ul class=td-sidebar-nav__section><li class=td-sidebar-nav__section-title><a href=/design/guides/ class="align-left pl-0 collapsed td-sidebar-link td-sidebar-link__section">Quick Guides&nbsp;&nbsp;<i class="fas fa-caret-right"></i></a></li><ul><li class=collapse id=designguides><a class="td-sidebar-link td-sidebar-link__page" id=m-designguidesdesigning-interviews href=/design/guides/designing-interviews/>User Interviews</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-designguidesempathy-map href=/design/guides/empathy-map/>Empathy Map</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-designguidesproblem-statement href=/design/guides/problem-statement/>Problem Statement</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-designguidesmapping-hierarchy href=/design/guides/mapping-hierarchy/>Mapping Hierarchy</a></li></ul></ul><ul class=td-sidebar-nav__section><li class=td-sidebar-nav__section-title><a href=/design/mockups/ class="align-left pl-0 collapsed td-sidebar-link td-sidebar-link__section">Mockups&nbsp;&nbsp;<i class="fas fa-caret-right"></i></a></li><ul><li class=collapse id=designmockups></li></ul></ul></li></ul></ul><ul class=td-sidebar-nav__section><li class=td-sidebar-nav__section-title><a href=/contribute/ class="align-left pl-0 collapsed td-sidebar-link td-sidebar-link__section">Contributing&nbsp;&nbsp;<i class="fas fa-caret-right"></i></a></li><ul><li class=collapse id=contribute><ul class=td-sidebar-nav__section><li class=td-sidebar-nav__section-title><a href=/contribute/code/ class="align-left pl-0 collapsed td-sidebar-link td-sidebar-link__section">Code&nbsp;&nbsp;<i class="fas fa-caret-right"></i></a></li><ul><li class=collapse id=contributecode><a class="td-sidebar-link td-sidebar-link__page" id=m-contributecodeworkflow href=/contribute/code/workflow/>Workflow</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-contributecodestyle-guide href=/contribute/code/style-guide/>Style Guide</a></li></ul></ul><ul class=td-sidebar-nav__section><li class=td-sidebar-nav__section-title><a href=/contribute/docs/ class="align-left pl-0 collapsed td-sidebar-link td-sidebar-link__section">Documentation&nbsp;&nbsp;<i class="fas fa-caret-right"></i></a></li><ul><li class=collapse id=contributedocs><a class="td-sidebar-link td-sidebar-link__page" id=m-contributedocsworkflow href=/contribute/docs/workflow/>Workflow</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-contributedocsstyle-guide href=/contribute/docs/style-guide/>Style Guide</a></li></ul></ul><a class="td-sidebar-link td-sidebar-link__page" id=m-contributecode-of-conduct href=/contribute/code-of-conduct/>Code of Conduct</a></li></ul></ul></ul></nav></div></div><div class="d-none d-xl-block col-xl-2 td-toc d-print-none"><div class="td-page-meta ml-2 pb-1 pt-2 mb-0"><a href=https://github.com/medic/cht-docs/edit/main/content/en/apps/reference/app-settings/transitions.md target=_blank><i class="fa fa-edit fa-fw"></i>Edit this page</a>
<a href="https://github.com/medic/cht-docs/issues/new?title=Improve+%27.transitions%27&labels=enhancement&body=Page:+/apps/reference/app-settings/transitions/%0aVersion:+2021-06-15%2017:20:01%20+0300%20+0300%0a---" target=_blank><i class="fab fa-github fa-fw"></i>Create documentation issue</a>
<a href=https://github.com/medic/cht-core/issues/new target=_blank><i class="fas fa-tasks fa-fw"></i>Create project issue</a></div><nav id=TableOfContents><ul><li><a href=#configuration>Configuration</a></li><li><a href=#available-transitions>Available transitions</a></li><li><a href=#transition-configuration-guide>Transition Configuration Guide</a><ul><li><a href=#multi_report_alerts>multi_report_alerts</a></li><li><a href=#death_reporting>death_reporting</a></li><li><a href=#registration>Registration</a></li><li><a href=#generate-shortcode-on-contacts>Generate Shortcode on Contacts</a></li><li><a href=#generate-patient-id-on-people>Generate Patient ID On People</a></li><li><a href=#update_notifications>update_notifications</a></li><li><a href=#muting>Muting</a></li><li><a href=#accept-patient-reports>Accept patient reports</a></li><li><a href=#accept-case-reports>Accept case reports</a></li><li><a href=#self_report>self_report</a></li><li><a href=#update_clinics>update_clinics</a></li></ul></li></ul></nav></div><main class="col-12 col-md-9 col-xl-8 pl-md-5" role=main><nav aria-label=breadcrumb class="d-none d-md-block d-print-none"><ol class="breadcrumb spb-1"><li class=breadcrumb-item><a href=https://docs.communityhealthtoolkit.org/apps/>CHT Applications</a></li><li class=breadcrumb-item><a href=https://docs.communityhealthtoolkit.org/apps/reference/>Reference</a></li><li class=breadcrumb-item><a href=https://docs.communityhealthtoolkit.org/apps/reference/app-settings/>app_settings.json</a></li><li class="breadcrumb-item active" aria-current=page><a href=https://docs.communityhealthtoolkit.org/apps/reference/app-settings/transitions/>.transitions</a></li></ol></nav><div class=td-content><h1>.transitions</h1><div class=lead><strong>Sentinel Transitions</strong>: functions executed when database documents change</div><p>When sentinel detects a document has changed it runs transitions against the doc. These transitions can be used to generate a short form patient id or assign a report to a facility.</p><h2 id=configuration>Configuration</h2><p>By default all transitions are disabled. They can be enabled by configuring the <code>transitions</code> property to have a key with the transitions name and a <code>truthy</code> value.
As of version 3.12.0 some transitions will partially run on the client for offline users. To opt out from client-side transitions, add a <code>"client_side: false"</code> property to the transition configuration.</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=color:#000;font-weight:700>{</span>
  <span style=color:#204a87;font-weight:700>&#34;transitions&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#000;font-weight:700>{</span>
    <span style=color:#204a87;font-weight:700>&#34;a&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#000;font-weight:700>{</span> <span style=color:#000;font-weight:700>},</span>
    <span style=color:#204a87;font-weight:700>&#34;b&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#204a87;font-weight:700>true</span><span style=color:#000;font-weight:700>,</span>
    <span style=color:#204a87;font-weight:700>&#34;c&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#000;font-weight:700>{</span> <span style=color:#204a87;font-weight:700>&#34;disable&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#204a87;font-weight:700>false</span> <span style=color:#000;font-weight:700>},</span>
    <span style=color:#204a87;font-weight:700>&#34;d&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#000;font-weight:700>{</span> <span style=color:#204a87;font-weight:700>&#34;disable&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#204a87;font-weight:700>true</span> <span style=color:#000;font-weight:700>},</span>
    <span style=color:#204a87;font-weight:700>&#34;e&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#000;font-weight:700>{</span> <span style=color:#204a87;font-weight:700>&#34;client_side&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#204a87;font-weight:700>false</span> <span style=color:#000;font-weight:700>}</span>
  <span style=color:#000;font-weight:700>}</span>
<span style=color:#000;font-weight:700>}</span>
</code></pre></div><p>In this example the <code>d</code> transition will not be applied, <code>a</code>, <code>b</code> <code>c</code> will be applied on the server and on the client, while <code>e</code> will only be applied on the server.</p><h2 id=available-transitions>Available transitions</h2><p>The following transitions are available and executed in order.</p><table><thead><tr><th>Key</th><th>Description</th></tr></thead><tbody><tr><td>maintain_info_document</td><td>Records metadata about the document such as when it was replicated. Enabled by default.</td></tr><tr><td><a href=#update_clinics>update_clinics</a></td><td>Adds a contact&rsquo;s info to a new data record. This is used to attribute an incoming SMS message or report to the appropriate contact. The <code>rc_code</code> value on the contact is used to match to the value of the form field set as the <code>facility_reference</code> in the <a href=https://docs.communityhealthtoolkit.org/apps/reference/app-settings/forms/#app_settingsjson-forms>JSON form definition</a>. This matching is useful when reports are sent on behalf of a facility by unknown or various phone numbers. If <code>facility_reference</code> is not set for a form, the contact match is attempted using the sender&rsquo;s phone number. If a form is not public and a match is not found then the <code>sys.facility_not_found</code> error is raised. A message will be sent out whenever this error is raised.</td></tr><tr><td><a href=#registration>registration</a></td><td>For registering a patient or place to a schedule. Performs some validation and creates the patient document if the patient does not already exist. Can create places (as of 3.8.x). Can assign schedules to places (as of 3.11.x)</td></tr><tr><td><a href=#accept-patient-reports>accept_patient_reports</a></td><td>Validates reports about a patient or place and silences relevant reminders.</td></tr><tr><td><a href=#accept-case-reports>accept_case_reports</a></td><td>Validates reports about a case, assigns the associated place_uuid, and silences relevant reminders. Available since 3.9.0</td></tr><tr><td><a href=#generate-shortcode-on-contacts>generate_shortcode_on_contacts</a></td><td>Automatically generates the <code>patient_id</code> on all person documents and the <code>place_id</code> on all place documents. Available since 3.8.x.</td></tr><tr><td><a href=#generate-patient-id-on-people>generate_patient_id_on_people</a></td><td><strong>Deprecated in 3.8.x</strong> Automatically generates the <code>patient_id</code> on all person documents. As of 3.8.x, also generates the <code>place_id</code> on all place documents and is an alias for <code>generate_shortcode_on_contacts</code>.</td></tr><tr><td>default_responses</td><td>Responds to the message with a confirmation or validation error.</td></tr><tr><td>update_sent_by</td><td>Sets the sent_by field of the report based on the sender&rsquo;s phone number.</td></tr><tr><td>update_sent_forms</td><td><strong>Deprecated in 3.7.x</strong> Update sent_forms property on facilities so we can setup reminders for specific forms. <em>As of 3.7.x, reminders no longer require this transition</em></td></tr><tr><td><a href=#death_reporting>death_reporting</a></td><td>Updates the deceased status of patients.</td></tr><tr><td>conditional_alerts</td><td>Executes the configured condition and sends an alert if the condition is met.</td></tr><tr><td><a href=#multi_report_alerts>multi_report_alerts</a></td><td>Similar to conditional_alerts, with more flexible configuration, including using different form types for the same alert.</td></tr><tr><td><a href=#update_notifications>update_notifications</a></td><td><strong>Deprecated in 3.2.x</strong> Mutes or unmutes scheduled messages based on configuration.</td></tr><tr><td>update_scheduled_reports</td><td>If a report has a month/week/week_number, year and clinic then look for duplicates and update those instead.</td></tr><tr><td>resolve_pending</td><td>Sets the state of pending messages to sent. It is useful during builds where we don&rsquo;t want any outgoing messages queued for sending.</td></tr><tr><td><a href=#muting>muting</a></td><td>Implements muting/unmuting actions of people and places. Available since 3.2.x. Is partially applied on the client, as of 3.12.0.</td></tr><tr><td><a href=https://docs.communityhealthtoolkit.org/apps/reference/app-settings/outbound/>mark_for_outbound</a></td><td>Enables outbound pushes. Available since 3.5.x</td></tr><tr><td><a href=#self_report>self_report</a></td><td>Maps patient to sender. Available since 3.9.x</td></tr></tbody></table><h2 id=transition-configuration-guide>Transition Configuration Guide</h2><p>Guides for how to setup specific transitions.</p><h3 id=multi_report_alerts>multi_report_alerts</h3><p>Send alert messages by SMS when specific conditions are received through reports. More flexible than simple Alerts.</p><p>Example: send SMS to the district manager when 2 CHWs within the same district report cholera or diarrhea symptoms within the last week.</p><p>Understanding the different types of reports used in the configuration:</p><pre><code>             previous suspected_cholera alert was sent
             |
             |           latest_report comes in, suspected_cholera alert is sent
             |           |
             v           v
---[---*-o---*--*--o-o---*]-------&gt;    time
                1        0
</code></pre><p><code>[]</code> : time window</p><p><code>*</code> and <code>o</code> : <code>reports</code> : any report that came in to the server.</p><p><code>*</code> : <code>counted_reports</code> : reports that came in that passed the <code>is_report_counted</code> filter function.</p><p><code>0</code>, <code>1</code> : <code>new_reports</code> : <code>counted_reports</code> that came in since the previous alert was sent. They haven&rsquo;t been messaged about yet.</p><h4 id=configuration-1>Configuration</h4><pre><code>&quot;multi_report_alerts&quot; : [
  {
    &quot;name&quot;: &quot;suspected_cholera&quot;,
    &quot;is_report_counted&quot;: &quot;function(report, latest_report) {  return latest_report.contact.parent.parent._id === report.contact.parent.parent._id; }&quot;,
    &quot;num_reports_threshold&quot;: 2,
    &quot;message&quot;: &quot;{{num_counted_reports}} patients with {{alert_name}} in {{time_window_in_days}} days reported at {{new_reports.0.contact.parent.name}}. New reports from: {{new_reports.0.contact.name}}, {{new_reports.1.contact.name}}, {{new_reports.2.contact.name}}.&quot;,
    &quot;recipients&quot;: [
      &quot;+123456&quot;,
      &quot;new_report.contact.phone&quot;, // sender of each report in new_reports
      &quot;new_report.contact.parent.parent.contact.phone&quot;, // contact person for the parent place of the sender of each report in new_reports.
      // If it's the same for several reports, only one message will be sent (recipient phone numbers are deduplicated before generating messages).
    ],
    &quot;time_window_in_days&quot;: 7,
    &quot;forms&quot;: [&quot;C&quot;, &quot;D&quot;] // Only Cholera and Diarrhea forms.
  }
]
</code></pre><p>Note that we are using Mustache templates for our message templates (anything with <code>{{}}</code>), and they use a <code>.</code> notation to access items in an array (e.g. <code>new_reports.1</code>) rather than a <code>[]</code> notation as in conventional javascript (<code>new_reports[1]</code>).</p><p>For performance reasons the <code>num_reports_threshold</code> cannot exceed 100.</p><h3 id=death_reporting>death_reporting</h3><p>Updates patient documents with a <code>date_of_death</code> field which updates how the patient is displayed in the UI.</p><h4 id=configuration-2>Configuration</h4><p>Configuration is stored in the <code>death_reporting</code> field of the settings.</p><table><thead><tr><th>Property</th><th>Description</th></tr></thead><tbody><tr><td><code>mark_deceased_forms</code></td><td>An array of form codes which will cause patients to be recorded as deceased.</td></tr><tr><td><code>undo_deceased_forms</code></td><td>An array of form codes which will remove the deceased date from the patient. Optional.</td></tr><tr><td><code>date_field</code></td><td>The path to the field in the report document which has the date the patient died. Optional: if not configured it defaults to the reported_date of the report.</td></tr></tbody></table><h5 id=example>Example</h5><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=color:#4e9a06>&#34;death_reporting&#34;</span><span style=color:#a40000>:</span> <span style=color:#000;font-weight:700>{</span>
  <span style=color:#204a87;font-weight:700>&#34;mark_deceased_forms&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#000;font-weight:700>[</span> <span style=color:#4e9a06>&#34;death&#34;</span> <span style=color:#000;font-weight:700>],</span>
  <span style=color:#204a87;font-weight:700>&#34;undo_deceased_forms&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#000;font-weight:700>[</span> <span style=color:#4e9a06>&#34;undo-death&#34;</span> <span style=color:#000;font-weight:700>],</span>
  <span style=color:#204a87;font-weight:700>&#34;date_field&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;fields.death_date&#34;</span>
<span style=color:#000;font-weight:700>}</span>
</code></pre></div><h3 id=registration>Registration</h3><p>Configuration is held at <code>app_settings.registrations</code>, as a list of objects connecting forms to validations, events and messages.</p><h4 id=events>Events</h4><p>Lists different events.</p><h5 id=on_create><code>on_create</code></h5><p>This is the only supported event.</p><h4 id=triggers>Triggers</h4><h5 id=add_patient><code>add_patient</code></h5><p>Sets the <code>patient_id</code> on the root of the registration document and creates the person doc if required. Can be configured to either use a provided ID or generate a new unique one.</p><h6 id=external-patient-id>External Patient ID</h6><p>If you are providing the patient id instead of having Sentinel generate you one, name the field in a <code>patient_id_field</code> key in <code>"params"</code>:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=color:#000;font-weight:700>{</span>
    <span style=color:#204a87;font-weight:700>&#34;name&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;on_create&#34;</span><span style=color:#000;font-weight:700>,</span>
    <span style=color:#204a87;font-weight:700>&#34;trigger&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;add_patient&#34;</span><span style=color:#000;font-weight:700>,</span>
    <span style=color:#204a87;font-weight:700>&#34;params&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;{\&#34;patient_id_field\&#34;: \&#34;external_id\&#34;}&#34;</span><span style=color:#000;font-weight:700>,</span>
    <span style=color:#204a87;font-weight:700>&#34;bool_expr&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;&#34;</span>
<span style=color:#000;font-weight:700>}</span>
</code></pre></div><p>In this example the provided id would be in <code>fields.external_id</code> on the registration document.</p><p><strong>NB:</strong> this field must not be called <code>patient_id</code>.
<strong>NB:</strong> the JSON passed in <code>"params"</code> should still be a string. Support for raw JSON as shown below exists, but is in beta and may not always work correctly in all situations, because kanso.json does not support it:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=color:#000;font-weight:700>{</span>
    <span style=color:#204a87;font-weight:700>&#34;params&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#000;font-weight:700>{</span><span style=color:#204a87;font-weight:700>&#34;patient_id_field&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;external_id&#34;</span><span style=color:#000;font-weight:700>},</span>
<span style=color:#000;font-weight:700>}</span>
</code></pre></div><h6 id=alternative-name-location>Alternative Name Location</h6><p>To provide an alternative location for the patient name, either provide a <code>patient_name_field</code> in <code>"params"</code> or provide it directly into the <code>"params"</code> field as a String:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=color:#000;font-weight:700>{</span>
    <span style=color:#204a87;font-weight:700>&#34;params&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;{\&#34;patient_name_field\&#34;: \&#34;full_name\&#34;}&#34;</span><span style=color:#000;font-weight:700>,</span>
<span style=color:#000;font-weight:700>}</span>
</code></pre></div><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=color:#000;font-weight:700>{</span>
    <span style=color:#204a87;font-weight:700>&#34;params&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;full_name&#34;</span><span style=color:#000;font-weight:700>,</span>
<span style=color:#000;font-weight:700>}</span>
</code></pre></div><p>The first format is required if you wish to also provide other params:</p><h6 id=contact-type>Contact Type</h6><p>If you have changed from the default contact hierarchy you will need to specify which type of contact the registration should create.</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=color:#000;font-weight:700>{</span>
    <span style=color:#204a87;font-weight:700>&#34;params&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;{ \&#34;contact_type\&#34;: \&#34;patient\&#34; }&#34;</span>
<span style=color:#000;font-weight:700>}</span>
</code></pre></div><h6 id=specific-parent-as-of-380>Specific Parent <em>as of 3.8.0</em></h6><p>By default, the newly created person will have the same parent as the report submitter.
A different parent may be selected by providing a location for the parent id. This field should
contain the <code>place_id</code> of the place in question.
If the selected parent is invalid - does not exist or does not respect the configured hierarchy</p><ul><li>the report is rejected as invalid and the person document is not created. As such
, <code>report_accepted</code> event should check if the report has a <code>patient</code> property (or similar).</li></ul><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json> <span style=color:#000;font-weight:700>{</span>
     <span style=color:#204a87;font-weight:700>&#34;params&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;{ \&#34;parent_id\&#34;: \&#34;parent_id\&#34; }&#34;</span>
 <span style=color:#000;font-weight:700>}</span>
</code></pre></div><h6 id=events-1>Events</h6><ul><li><code>parent_field_not_provided</code> - triggered when the report does not have the required parent_id field</li><li><code>parent_invalid</code> - triggered when selected parent is invalid (parent document is found and
either does not have a configured type or its type is not configured to be a parent to the
person type to be created)</li><li><code>parent_not_found</code> - triggered when selected parent is not found</li></ul><p>The selected parent (if found) can be accessed by using the <code>parent</code> path in error messages:
<code>Cannot create a person type "patient" under parent {{parent.place_id}}({{parent.contact_type}})</code></p><h5 id=add_patient_id><code>add_patient_id</code></h5><p><strong>Deprecated in favour of <code>add_patient</code>.</strong> Previously this only added a <code>patient_id</code> to the root of the registration form. This functionality has been merged into <code>add_patient</code>. Now, using this event will result in the same functionality as described in <code>add_patient</code> above.</p><h5 id=add_expected_date><code>add_expected_date</code></h5><h5 id=add_birth_date><code>add_birth_date</code></h5><h5 id=assign_schedule><code>assign_schedule</code></h5><h5 id=clear_schedule><code>clear_schedule</code></h5><h5 id=add_place-as-of-380><code>add_place</code> <em>as of 3.8.0</em></h5><p>Sets the <code>place_id</code> on the root of the registration document and creates the place doc with the
provided type.</p><p>By default, the created place would have the same parent as the submitter. If such a combination is
invalid - for example a contact under a &ldquo;clinic&rdquo; attempts to create a new &ldquo;health_center&rdquo; - the
report will be rejected as errored and the place document will not be created. As such,
<code>report_accepted</code> event should check if the report has a <code>place</code> property (or similar).</p><p>The created place does not have a primary contact.
The created place can be accessed by the <code>place</code> path in messages:
<code>Place {{place.name}}({{place.place_id}}) added to {{place.parent.name}}({{place.parent.place_id}})</code></p><h6 id=contact-type-1>Contact Type</h6><p>Specifying the contact type is required, even if not using configurable hierarchies.
The selected contact type must be a configured place type.</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=color:#000;font-weight:700>{</span>
    <span style=color:#204a87;font-weight:700>&#34;params&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;{ \&#34;contact_type\&#34;: \&#34;clinic\&#34; }&#34;</span>
<span style=color:#000;font-weight:700>}</span>
</code></pre></div><h6 id=specific-parent>Specific Parent</h6><p>By default, the newly created place will have the same parent as the report submitter.
A different parent may be selected by providing a location for the parent id. This field should
contain the <code>place_id</code> of the place in question.
If the selected parent is invalid - does not exist or is not an acceptable parent to the
selected type in the configured hierarchy - the report will be rejected as errored.</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json> <span style=color:#000;font-weight:700>{</span>
     <span style=color:#204a87;font-weight:700>&#34;params&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;{ \&#34;parent_id\&#34;: \&#34;parent_id\&#34; }&#34;</span>
 <span style=color:#000;font-weight:700>}</span>
</code></pre></div><h6 id=events-2>Events</h6><ul><li><code>parent_field_not_provided</code> - triggered when the report does not have the required parent_id field</li><li><code>parent_invalid</code> - triggered when selected parent is invalid (parent document is found and
either does not have a configured type or its type is not configured to be a parent to the
place type to be created)</li><li><code>parent_not_found</code> - triggered when selected parent is not found</li></ul><p>The selected parent (if found) can be accessed by using the <code>parent</code> path in error messages:
<code>'Cannot create a place type "health_center" under parent {{parent.place_id}}({{parent.contact_type}})'</code></p><h6 id=alternative-name-location-1>Alternative Name Location</h6><p>The created place&rsquo;s name is provided in the <code>place_name</code> field by default.
To provide an alternative location for the place name, provide a <code>place_name_field</code> in
<code>"params"</code>:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=color:#000;font-weight:700>{</span>
    <span style=color:#204a87;font-weight:700>&#34;params&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;{\&#34;place_name_field\&#34;: \&#34;clinic_name\&#34;}&#34;</span><span style=color:#000;font-weight:700>,</span>
<span style=color:#000;font-weight:700>}</span>
</code></pre></div><h5 id=add_case-as-of-390><code>add_case</code> <em>as of 3.9.0</em></h5><p>Sets the <code>case_id</code> on the root of the registration document.</p><h3 id=generate-shortcode-on-contacts>Generate Shortcode on Contacts</h3><p>No custom configuration for <code>generate_shortcode_on_contacts</code>.</p><h3 id=generate-patient-id-on-people>Generate Patient ID On People</h3><p><strong>Deprecated since 3.8.x</strong> in favor of <code>generate_shortcode_on_contacts</code></p><p>No custom configuration for <code>generate_patient_id_on_people</code>.</p><h3 id=update_notifications>update_notifications</h3><p><strong>Deprecated in favor of <a href=#muting>Muting</a></strong></p><h4 id=configuration-3>Configuration</h4><pre><code>&quot;notifications&quot;: {
    &quot;off_form&quot;: &quot;OFF&quot;,
    &quot;on_form&quot;: &quot;ON&quot;,
    &quot;validations&quot;: {
      &quot;join_responses&quot;: true,
      &quot;list&quot;: []
    },
    &quot;messages&quot;: [
      {
        &quot;translation_key&quot;: &quot;&quot;,
        &quot;event_type&quot;: &quot;on_mute&quot;,
        &quot;recipient&quot;: &quot;reporting_unit&quot;
      },
      {
       &quot;translation_key&quot;: &quot;&quot;,
        &quot;event_type&quot;: &quot;on_unmute&quot;,
        &quot;recipient&quot;: &quot;reporting_unit&quot;
      },
      {
        &quot;translation_key&quot;: &quot;&quot;,
        &quot;event_type&quot;: &quot;patient_not_found&quot;,
        &quot;recipient&quot;: &quot;reporting_unit&quot;
      }
    ]
  }
</code></pre><h3 id=muting>Muting</h3><p>Implements muting/unmuting of persons and places. Supports multiple forms for each action, for webapp and sms workflows.</p><h5 id=muting-action>Muting action</h5><p>As of 3.12.0, client-side muting only runs on new reports or new contacts, before they are saved in the local database:</p><ul><li>updates the target contact and all its descendants<sup>[10]</sup>, setting the <code>muted</code> property equal to the device&rsquo;s current <code>date</code> in ISO format<sup>[8]</sup>.</li><li>adds/updates the <code>muting_history</code><sup>[11]</sup> property on every updated contact, to keep track of all the updates that have been processed client-side, as well as the last known server-side state of the contact and sets the <code>last_update</code> property to <code>client_side</code></li><li>updates the report doc to add a <code>client_side_transitions</code> property to track which transitions have run client-side</li></ul><p>Server-side:</p><ul><li>updates the target contact and all its descendants<sup>[1]</sup>, setting the <code>muted</code> property equal to the current <code>date</code> in ISO format<sup>[2]</sup>. If the contact was already muted by a client, the <code>muted</code> date will be overwritten. The client-side <code>muting_history</code> will have a copy of the client-side muting date.</li><li>adds a <code>muting_history</code> entry to Sentinel <code>info</code> docs for every updated contact<sup>[7]</sup></li><li>updates all connected registrations<sup>[3]</sup>, changing the state of all unsent<sup>[4]</sup> <code>scheduled_tasks</code> to <code>muted</code></li><li>as of 3.12.0, updates the contact&rsquo;s client-side <code>muting_history</code> to set the <code>last_update</code> property to <code>server_side</code> and update the <code>server_side</code> section with the current date and muted state.</li><li>as of 3.12.0, if the report was processed client-side, all &ldquo;following&rdquo; muting/unmuting events that have affected the same contacts will be replayed. This means the transition <em>could</em> end up running multiple times over the same report<sup>[9]</sup>.</li></ul><h5 id=unmuting-action>Unmuting action:</h5><p>As of 3.12.0, client-side unmuting only runs on new reports before they are saved in the local database:</p><ul><li>updates the target contact&rsquo;s topmost muted ancestor<sup>[10][5]</sup> and all its descendants, removing the <code>muted</code> property.</li><li>adds/updates the <code>muting_history</code><sup>[9]</sup> property on every updated contact, sets the last known server-side state of the contact and sets the <code>last_update</code> property to <code>client_side</code></li><li>updates the report doc to add a <code>client_side_transitions</code> property to track which transitions have run client-side</li></ul><p>Server-side:</p><ul><li>updates the target contact&rsquo;s topmost muted ancestor<sup>[1][5]</sup> and all its descendants, removing the <code>muted</code> property</li><li>adds a <code>muting_history</code> entry to Sentinel <code>info</code> docs for every updated contact<sup>[7]</sup></li><li>updates all connected registrations<sup>[3]</sup>, changing the state of all present/future<sup>[6]</sup> <code>muted</code> <code>scheduled_tasks</code> to <code>scheduled</code></li><li>as of 3.12.0, updates the contact&rsquo;s client-side <code>muting_history</code> to set the <code>last_update</code> property to <code>server_side</code> and update the <code>server_side</code> section with the current date and muted state.</li><li>as of 3.12.0, if the report was processed client-side, all &ldquo;following&rdquo; muting/unmuting events that have affected the same contacts will be replayed. This means the transition <em>could</em> end up running multiple times over the same report<sup>[10]</sup>.</li></ul><p>[1] Contacts that are already in the correct state are skipped. This applies to updates to the contact itself, updates to the Sentinel <code>muting_history</code> and to the connected registrations (registrations of a contact that is already in the correct state will not be updated).<br>[2] The date represents the moment Sentinel has processed the muting action<br>[3] target contact and descendants&rsquo; registrations<br>[4] <code>scheduled_tasks</code> being in either <code>scheduled</code> or <code>pending</code> state<br>[5] Because the muted state is inherited, unmuting cascades upwards to the highest level muted ancestor. If none of the ancestors is muted, unmuting cascades downwards only.<br>[6] <code>scheduled_tasks</code> which are due today or in the future. All <code>scheduled_tasks</code> with a due date in the past will remain unchanged.<br>[8] The date represents the device&rsquo;s date when the report is processed.<br>[9] Replaying is required due to how PouchDB &lt;-> CouchDB synchronization does not respect the order in which the documents have been created, to ensure that contacts end up in the correct muted state.<br>[10] The updated contacts are limited to the contacts available on the device.</p><h5 id=7-muting-history>[7] Muting history</h5><p>Each time the <code>muted</code> state of a contact changes, an entry is added to a <code>muting_history</code> list saved in Sentinel <code>info</code> docs (stored as an array property with the same name).
Entries in <code>muting_history</code> contain the following information:</p><table><thead><tr><th>Property</th><th>Description</th></tr></thead><tbody><tr><td>muted</td><td>Boolean representing the muted state</td></tr><tr><td>date</td><td>Date in ISO Format</td></tr><tr><td>report_id</td><td>An <code>_id</code> reference to the report that triggered the action</td></tr></tbody></table><h5 id=11-client-side-muting-history-as-of-3120>[11] Client-side Muting history as of 3.12.0</h5><p>Each time the client changes the <code>muted</code> state of a contact, an entry is added to a <code>muting_history</code> property on the contact&rsquo;s doc. The <code>last_update</code> entry is also changed to <code>client_side</code>.
The <code>muting_history</code> property contains the following information:</p><table><thead><tr><th>Property</th><th>Values</th><th>Description</th></tr></thead><tbody><tr><td>last_update</td><td><code>server_side</code> or <code>client_side</code></td><td>Updated every time a service updates the contact, with the corresponding value</td></tr><tr><td>server_side</td><td>Object</td><td></td></tr><tr><td>server_side.muted</td><td><code>true</code> or <code>false</code></td><td>Last known server-side muting state</td></tr><tr><td>server_side.date</td><td>Date in ISO format</td><td>Last known server-side muting/unmuting date</td></tr><tr><td>client_side</td><td>Array</td><td>Client-side muting/unmuting events list.<br>New events are pushed at the end of this list and it should never be re-ordered.<br>The list represents the &ldquo;chronological&rdquo; order in which the reports that triggered muting were created.</td></tr><tr><td>client_side[].muted</td><td><code>true</code> or <code>false</code></td><td>Client-side muting state</td></tr><tr><td>client_side[].date</td><td>Date in ISO format</td><td>Client-side muting/unmuting date</td></tr><tr><td>client_side[].report_id</td><td>uuid</td><td>The uuid of the muting/unmuting report that triggered the update</td></tr></tbody></table><h4 id=configuration-4>Configuration</h4><p>Configuration is stored in the <code>muting</code> field of <code>app_settings.json</code>.</p><table><thead><tr><th>Property</th><th>Description</th></tr></thead><tbody><tr><td><code>mute_forms</code></td><td>An array of form codes which will trigger muting. <strong>Required</strong></td></tr><tr><td><code>unmute_forms</code></td><td>An array of form codes which will trigger unmuting. Optional.</td></tr><tr><td><code>validations</code></td><td>List of form fields validations. All mute & unmute forms will be subjected to these validation rules. Invalid forms will not trigger muting/unmuting actions. Optional.</td></tr><tr><td><code>messages</code></td><td>List of tasks/errors that will be created, determined by <code>event_type</code>. Optional.</td></tr></tbody></table><p>Supported <code>events_types</code> are:</p><table><thead><tr><th>Event Type</th><th>Trigger</th></tr></thead><tbody><tr><td><code>mute</code></td><td>On successful <code>mute</code> action</td></tr><tr><td><code>unmute</code></td><td>On successful <code>unmute</code> action</td></tr><tr><td><code>already_muted</code></td><td>On <code>mute</code> action, when target contact is already muted</td></tr><tr><td><code>already_unmuted</code></td><td>On <code>unmute</code> action, when target contact is already unmuted</td></tr><tr><td><code>contact_not_found</code></td><td>Either mute or unmute actions when target contact is not found</td></tr></tbody></table><div class="alert alert-primary" role=alert><h4 class=alert-heading>Note</h4><p>When muting events are processed both client-side and server-side, there is no guarantee that the state of the database will be the same between the two processing events. Some possible cases where the data is changed in significant ways, that will affect the final muting state are:</p><ul><li>updated muting settings between client and server processing of the same report / contact</li><li>editing the muting/unmuting reports before they are synced, but after the transition ran locally, that either change the target contact or change the validity of the report</li><li>deleting muting/unmuting reports before they are synced</li><li>validation rules that depend on database data (for example using the &ldquo;exists&rdquo; rule, which will run over different data sets, a report could be valid for the client but invalid for the server and the other way around).</li><li>conflicts that overwrite <code>muting_history</code> for contacts</li><li>delayed sync for some docs (either contacts or reports) could exacerbate the above because of the &ldquo;replay&rdquo; behavior.</li></ul></div><h5 id=example-1>Example</h5><pre><code>&quot;muting&quot;: {
    &quot;mute_forms&quot;: [&quot;mute_person&quot;, &quot;mute_clinic&quot;],
    &quot;unmute_forms&quot;: [&quot;unmute_person&quot;, &quot;unmute_clinic&quot;],
    &quot;validations&quot;: {
      &quot;join_responses&quot;: true,
      &quot;list&quot;: []
    },
    &quot;messages&quot;: [
      {
        &quot;translation_key&quot;: &quot;&quot;,
        &quot;event_type&quot;: &quot;mute&quot;,
        &quot;recipient&quot;: &quot;reporting_unit&quot;
      },
      {
        &quot;translation_key&quot;: &quot;&quot;,
        &quot;event_type&quot;: &quot;unmute&quot;,
        &quot;recipient&quot;: &quot;reporting_unit&quot;
      },
      {
        &quot;translation_key&quot;: &quot;&quot;,
        &quot;event_type&quot;: &quot;already_muted&quot;,
        &quot;recipient&quot;: &quot;reporting_unit&quot;
      },
      {
        &quot;translation_key&quot;: &quot;&quot;,
        &quot;event_type&quot;: &quot;already_unmuted&quot;,
        &quot;recipient&quot;: &quot;reporting_unit&quot;
      },
      {
        &quot;translation_key&quot;: &quot;&quot;,
        &quot;event_type&quot;: &quot;contact_not_found&quot;,
        &quot;recipient&quot;: &quot;reporting_unit&quot;
      }
    ]
  }
</code></pre><h3 id=accept-patient-reports>Accept patient reports</h3><p>Allow reporting about patient and place centric workflows by</p><ul><li>validating the report,</li><li>assigning the relevant subject (patient or place) to the report if a registration with the given shortcode (patient_id or place_id) exists,</li><li>clearing messages on the registration, and</li><li>generating response messages on the report.</li></ul><h4 id=example-2>Example</h4><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=color:#4e9a06>&#34;transitions&#34;</span><span style=color:#a40000>:</span> <span style=color:#000;font-weight:700>{</span>
  <span style=color:#204a87;font-weight:700>&#34;accept_patient_reports&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#204a87;font-weight:700>true</span>
<span style=color:#000;font-weight:700>}</span><span style=color:#a40000>,</span>
<span style=color:#4e9a06>&#34;registrations&#34;</span><span style=color:#a40000>:</span> <span style=color:#000;font-weight:700>[{</span>
  <span style=color:#204a87;font-weight:700>&#34;form&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;P&#34;</span><span style=color:#000;font-weight:700>,</span>
  <span style=color:#204a87;font-weight:700>&#34;events&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#000;font-weight:700>[{</span>
    <span style=color:#204a87;font-weight:700>&#34;name&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;on_create&#34;</span><span style=color:#000;font-weight:700>,</span>
    <span style=color:#204a87;font-weight:700>&#34;trigger&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;assign_schedule&#34;</span><span style=color:#000;font-weight:700>,</span>
    <span style=color:#204a87;font-weight:700>&#34;params&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;ANC Reminders&#34;</span><span style=color:#000;font-weight:700>,</span>
    <span style=color:#204a87;font-weight:700>&#34;bool_expr&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;!doc.fields.last_menstrual_period || !(/^[0-9]+$/.test(doc.fields.last_menstrual_period))&#34;</span>
  <span style=color:#000;font-weight:700>}]</span>
<span style=color:#000;font-weight:700>}]</span><span style=color:#a40000>,</span>
<span style=color:#4e9a06>&#34;schedules&#34;</span><span style=color:#a40000>:</span> <span style=color:#000;font-weight:700>[{</span>
  <span style=color:#204a87;font-weight:700>&#34;name&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;ANC Reminders&#34;</span><span style=color:#000;font-weight:700>,</span>
  <span style=color:#204a87;font-weight:700>&#34;translation_key&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;schedule.anc_no_lmp&#34;</span><span style=color:#000;font-weight:700>,</span>
  <span style=color:#204a87;font-weight:700>&#34;summary&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;&#34;</span><span style=color:#000;font-weight:700>,</span>
  <span style=color:#204a87;font-weight:700>&#34;description&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;&#34;</span><span style=color:#000;font-weight:700>,</span>
  <span style=color:#204a87;font-weight:700>&#34;start_from&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;reported_date&#34;</span><span style=color:#000;font-weight:700>,</span>
  <span style=color:#204a87;font-weight:700>&#34;messages&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#000;font-weight:700>[]</span>
<span style=color:#000;font-weight:700>}]</span><span style=color:#a40000>,</span>
<span style=color:#4e9a06>&#34;patient_reports&#34;</span><span style=color:#a40000>:</span> <span style=color:#000;font-weight:700>[{</span>
  <span style=color:#204a87;font-weight:700>&#34;form&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;pregnancy_visit&#34;</span><span style=color:#000;font-weight:700>,</span>
  <span style=color:#204a87;font-weight:700>&#34;silence_type&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;ANC Reminders&#34;</span><span style=color:#000;font-weight:700>,</span>
  <span style=color:#204a87;font-weight:700>&#34;silence_for&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;8 days&#34;</span><span style=color:#000;font-weight:700>,</span>
  <span style=color:#204a87;font-weight:700>&#34;fields&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#000;font-weight:700>[],</span>
  <span style=color:#204a87;font-weight:700>&#34;validations&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#000;font-weight:700>{},</span>
  <span style=color:#204a87;font-weight:700>&#34;messages&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#000;font-weight:700>[{</span>
    <span style=color:#204a87;font-weight:700>&#34;translation_key&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;messages.pregnancy_visit&#34;</span><span style=color:#000;font-weight:700>,</span>
    <span style=color:#204a87;font-weight:700>&#34;event_type&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;report_accepted&#34;</span><span style=color:#000;font-weight:700>,</span>
    <span style=color:#204a87;font-weight:700>&#34;recipient&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;clinic&#34;</span>
  <span style=color:#000;font-weight:700>}]</span>
<span style=color:#000;font-weight:700>}]</span>
</code></pre></div><h3 id=accept-case-reports>Accept case reports</h3><p>Allow reporting about case centric workflows by</p><ul><li>validating the report configuration documentation,</li><li>assigning the relevant place to the report if a registration with the given case_id exists,</li><li>clearing messages on the registration, and</li><li>generating response messages on the report.</li></ul><h4 id=example-3>Example</h4><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=color:#4e9a06>&#34;registrations&#34;</span><span style=color:#a40000>:</span> <span style=color:#000;font-weight:700>[{</span>
  <span style=color:#204a87;font-weight:700>&#34;form&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;8&#34;</span><span style=color:#000;font-weight:700>,</span>
  <span style=color:#204a87;font-weight:700>&#34;events&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#000;font-weight:700>[{</span>
    <span style=color:#204a87;font-weight:700>&#34;name&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;on_create&#34;</span><span style=color:#000;font-weight:700>,</span>
    <span style=color:#204a87;font-weight:700>&#34;trigger&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;add_case&#34;</span>
  <span style=color:#000;font-weight:700>}]</span>
<span style=color:#000;font-weight:700>}]</span><span style=color:#a40000>,</span>
<span style=color:#4e9a06>&#34;accept_case_reports&#34;</span><span style=color:#a40000>:</span> <span style=color:#000;font-weight:700>[{</span>
  <span style=color:#204a87;font-weight:700>&#34;form&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;SIGNOFF&#34;</span><span style=color:#000;font-weight:700>,</span>
  <span style=color:#204a87;font-weight:700>&#34;validations&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#000;font-weight:700>{},</span>
  <span style=color:#204a87;font-weight:700>&#34;messages&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#000;font-weight:700>[{</span>
    <span style=color:#204a87;font-weight:700>&#34;event_type&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;report_accepted&#34;</span><span style=color:#000;font-weight:700>,</span>
    <span style=color:#204a87;font-weight:700>&#34;bool_expr&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;some expression&#34;</span><span style=color:#000;font-weight:700>,</span>
    <span style=color:#204a87;font-weight:700>&#34;message&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;some message&#34;</span><span style=color:#000;font-weight:700>,</span>
    <span style=color:#204a87;font-weight:700>&#34;recipient&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;some recipients&#34;</span>
  <span style=color:#000;font-weight:700>}]</span>
<span style=color:#000;font-weight:700>}]</span>
</code></pre></div><h3 id=self_report>self_report</h3><p>Updates a <code>data_record</code> to set its patient to its sender. The resulting doc will have <code>fields.patient_uuid</code> and <code>fields.patient_id</code> filled with the sender&rsquo;s information. Provides hydrated patient information to subsequent transitions.
The <code>sender</code> is the contact associated with the phone number that sent the original SMS.<br>If a doc already contains a <code>patient</code> field, does not have a sender or its <code>form</code> is not configured to be enabled for this transition, it will be ignored.</p><h4 id=configuration-5>Configuration</h4><p>Configuration is stored in the <code>self_report</code> field of <code>app_settings.json</code> as a list of objects connecting forms to messages.
Every object should have this structure:</p><table><thead><tr><th>Property</th><th>Description</th></tr></thead><tbody><tr><td><code>form</code></td><td>Form code. <strong>Required</strong></td></tr><tr><td><code>messages</code></td><td>List of tasks/errors that will be created, determined by <code>event_type</code>. Optional.</td></tr></tbody></table><p>Supported <code>events_types</code> are:</p><table><thead><tr><th>Event Type</th><th>Trigger</th></tr></thead><tbody><tr><td><code>report_accepted</code></td><td>On successful sender updating</td></tr><tr><td><code>sender_not_found</code></td><td>Sender not found</td></tr></tbody></table><h5 id=example-4>Example</h5><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=color:#4e9a06>&#34;self_report&#34;</span><span style=color:#a40000>:</span> <span style=color:#000;font-weight:700>[</span>
  <span style=color:#000;font-weight:700>{</span>
    <span style=color:#204a87;font-weight:700>&#34;form&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;FORM&#34;</span><span style=color:#000;font-weight:700>,</span>
    <span style=color:#204a87;font-weight:700>&#34;messages&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#000;font-weight:700>[</span>
      <span style=color:#000;font-weight:700>{</span>
        <span style=color:#204a87;font-weight:700>&#34;event_type&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;report_accepted&#34;</span><span style=color:#000;font-weight:700>,</span>
        <span style=color:#204a87;font-weight:700>&#34;recipient&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;reporting_unit&#34;</span><span style=color:#000;font-weight:700>,</span>
        <span style=color:#204a87;font-weight:700>&#34;translation_key&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;messages.form.report_accepted&#34;</span>
      <span style=color:#000;font-weight:700>},</span>
      <span style=color:#000;font-weight:700>{</span>
        <span style=color:#204a87;font-weight:700>&#34;event_type&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;sender_not_found&#34;</span><span style=color:#000;font-weight:700>,</span>
        <span style=color:#204a87;font-weight:700>&#34;recipient&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;reporting_unit&#34;</span><span style=color:#000;font-weight:700>,</span>
        <span style=color:#204a87;font-weight:700>&#34;translation_key&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;messages.form.sender_not_found&#34;</span>
      <span style=color:#000;font-weight:700>}</span>
    <span style=color:#000;font-weight:700>]</span>
  <span style=color:#000;font-weight:700>},</span>
  <span style=color:#000;font-weight:700>{</span>
    <span style=color:#204a87;font-weight:700>&#34;form&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;OTHER&#34;</span><span style=color:#000;font-weight:700>,</span>
    <span style=color:#204a87;font-weight:700>&#34;messages&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#000;font-weight:700>[</span>
      <span style=color:#000;font-weight:700>{</span>
        <span style=color:#204a87;font-weight:700>&#34;event_type&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;report_accepted&#34;</span><span style=color:#000;font-weight:700>,</span>
        <span style=color:#204a87;font-weight:700>&#34;recipient&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;reporting_unit&#34;</span><span style=color:#000;font-weight:700>,</span>
        <span style=color:#204a87;font-weight:700>&#34;translation_key&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;messages.other.report_accepted&#34;</span>
      <span style=color:#000;font-weight:700>},</span>
      <span style=color:#000;font-weight:700>{</span>
        <span style=color:#204a87;font-weight:700>&#34;event_type&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;sender_not_found&#34;</span><span style=color:#000;font-weight:700>,</span>
        <span style=color:#204a87;font-weight:700>&#34;recipient&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;reporting_unit&#34;</span><span style=color:#000;font-weight:700>,</span>
        <span style=color:#204a87;font-weight:700>&#34;translation_key&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;messages.other.sender_not_found&#34;</span>
      <span style=color:#000;font-weight:700>}</span>
    <span style=color:#000;font-weight:700>]</span>
  <span style=color:#000;font-weight:700>}</span>
<span style=color:#000;font-weight:700>]</span>
</code></pre></div><h3 id=update_clinics>update_clinics</h3><p>Adds a contact’s info to a data record so as to attribute an incoming SMS message or report to the appropriate contact.</p><h4 id=configuration-6>Configuration</h4><p>As of version 3.12 you can add configuration to send a message whenever a contact match fails while running this transition. Configuration is stored in the <code>update_clinics</code> field of app_settings.json as a list of objects connecting forms to messages. Every object should have this structure:</p><table><thead><tr><th>Property</th><th>Description</th></tr></thead><tbody><tr><td><code>form</code></td><td>Form code.</td></tr><tr><td><code>messages</code></td><td>List of tasks/errors that will be created, determined by <code>event_type</code>.</td></tr></tbody></table><p>Supported <code>events_types</code> are:</p><table><thead><tr><th>Event Type</th><th>Trigger</th></tr></thead><tbody><tr><td><code>sys.facility_not_found</code></td><td>Facility not found</td></tr></tbody></table><p>If this configuration is not set then the message defaults to what is set in the <code>messages.generic.sys.facility_not_found</code> key.</p><h5 id=example-5>Example</h5><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=color:#4e9a06>&#34;update_clinics&#34;</span><span style=color:#a40000>:</span> <span style=color:#000;font-weight:700>[</span>
  <span style=color:#000;font-weight:700>{</span>
    <span style=color:#204a87;font-weight:700>&#34;form&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;FORM&#34;</span><span style=color:#000;font-weight:700>,</span>
    <span style=color:#204a87;font-weight:700>&#34;messages&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#000;font-weight:700>[</span>
      <span style=color:#000;font-weight:700>{</span>
        <span style=color:#204a87;font-weight:700>&#34;event_type&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;sys.facility_not_found&#34;</span><span style=color:#000;font-weight:700>,</span>
        <span style=color:#204a87;font-weight:700>&#34;recipient&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;reporting_unit&#34;</span><span style=color:#000;font-weight:700>,</span>
        <span style=color:#204a87;font-weight:700>&#34;translation_key&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;sys.facility_not_found&#34;</span>
      <span style=color:#000;font-weight:700>}</span>
    <span style=color:#000;font-weight:700>]</span>
  <span style=color:#000;font-weight:700>},</span>
  <span style=color:#000;font-weight:700>{</span>
    <span style=color:#204a87;font-weight:700>&#34;form&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;OTHER&#34;</span><span style=color:#000;font-weight:700>,</span>
    <span style=color:#204a87;font-weight:700>&#34;messages&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#000;font-weight:700>[</span>
      <span style=color:#000;font-weight:700>{</span>
        <span style=color:#204a87;font-weight:700>&#34;event_type&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;sys.facility_not_found&#34;</span><span style=color:#000;font-weight:700>,</span>
        <span style=color:#204a87;font-weight:700>&#34;recipient&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;reporting_unit&#34;</span><span style=color:#000;font-weight:700>,</span>
        <span style=color:#204a87;font-weight:700>&#34;translation_key&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;messages.other.facility_not_found&#34;</span>
      <span style=color:#000;font-weight:700>}</span>
    <span style=color:#000;font-weight:700>]</span>
  <span style=color:#000;font-weight:700>}</span>
<span style=color:#000;font-weight:700>]</span>
</code></pre></div><h2 id=related-content>Related Content</h2><div class=section-index><hr class=panel-line><div class=entry><h5><a href=/apps/reference/app-settings/#sms-recipient-resolution>CHT Applications >
Reference >
app_settings.json
: Sms Recipient Resolution</a></h5><p class=one-liner>Settings: The primary location of settings for CHT applications</p></div></div><style>.feedback--answer{display:inline-block}.feedback--answer-no{margin-left:1em}.feedback--response{display:none;margin-top:1em}.feedback--response__visible{display:block}</style><h2 class=feedback--title>Feedback</h2><p class=feedback--question>Was this page helpful?</p><button class="feedback--answer feedback--answer-yes">Yes</button>
<button class="feedback--answer feedback--answer-no">No</button><p class="feedback--response feedback--response-yes">Glad to hear it! Please <a href=https://github.com/medic/cht-docs/issues/new>tell us how we can improve</a>.</p><p class="feedback--response feedback--response-no">Sorry to hear that. Please <a href=https://github.com/medic/cht-docs/issues/new>tell us how we can improve</a>.</p><script>const yesButton=document.querySelector('.feedback--answer-yes');const noButton=document.querySelector('.feedback--answer-no');const yesResponse=document.querySelector('.feedback--response-yes');const noResponse=document.querySelector('.feedback--response-no');const disableButtons=()=>{yesButton.disabled=true;noButton.disabled=true;};const sendFeedback=(value)=>{if(typeof ga!=='function')return;const args={command:'send',hitType:'event',category:'Helpful',action:'click',label:window.location.pathname,value:value};ga(args.command,args.hitType,args.category,args.action,args.label,args.value);};yesButton.addEventListener('click',()=>{yesResponse.classList.add('feedback--response__visible');disableButtons();sendFeedback(1);});noButton.addEventListener('click',()=>{noResponse.classList.add('feedback--response__visible');disableButtons();sendFeedback(0);});</script><br><div class="text-muted mt-5 pt-3 border-top">Last modified 15.06.2021: <a href=https://github.com/medic/cht-docs/commit/6ffcb175e9caad2e4024e9c8d26e3caea6b75309>Adds documentation about client-side muting. (#504) (6ffcb17)</a><div class="d-xl-none d-print-none meta-links"><div class="td-page-meta ml-2 pb-1 pt-2 mb-0"><a href=https://github.com/medic/cht-docs/edit/main/content/en/apps/reference/app-settings/transitions.md target=_blank><i class="fa fa-edit fa-fw"></i>Edit this page</a>
<a href="https://github.com/medic/cht-docs/issues/new?title=Improve+%27.transitions%27&labels=enhancement&body=Page:+/apps/reference/app-settings/transitions/%0aVersion:+2021-06-15%2017:20:01%20+0300%20+0300%0a---" target=_blank><i class="fab fa-github fa-fw"></i>Create documentation issue</a>
<a href=https://github.com/medic/cht-core/issues/new target=_blank><i class="fas fa-tasks fa-fw"></i>Create project issue</a></div></div></div></div></main></div></div><footer class="bg-dark py-5 row d-print-none"><div class="container-fluid mx-sm-5"><div class=row><div class="col-6 col-sm-4 text-xs-center order-sm-2"></div><div class="col-6 col-sm-4 text-right text-xs-center order-sm-3"></div><div class="col-12 col-sm-4 text-center py-2 order-sm-2"><small class=text-white>&copy; 2022 CHT All Rights Reserved</small>
<small class=ml-1><a href="https://docs.google.com/document/d/1MaI1rgYMNyCZF2eEjBuvnBDoCYHDKlx4k_N5pkDiWu8/edit?usp=sharing" target=_blank>Privacy Policy</a></small></div></div></div></footer></div><script src=https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js integrity=sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49 crossorigin=anonymous></script><script src=https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js integrity=sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy crossorigin=anonymous></script><script src=/js/main.min.fe96fb3036eca951c7eb0789e66bdef1d3d7e75919b9ecf624883f34a0f4272e.js integrity="sha256-/pb7MDbsqVHH6weJ5mve8dPX51kZuez2JIg/NKD0Jy4=" crossorigin=anonymous></script></body></html>