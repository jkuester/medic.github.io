<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Community Health Toolkit â€“ Reference Documentation</title><link>https://docs.communityhealthtoolkit.org/beta/apps/reference/</link><description>Recent content in Reference Documentation on Community Health Toolkit</description><generator>Hugo -- gohugo.io</generator><atom:link href="https://docs.communityhealthtoolkit.org/beta/apps/reference/index.xml" rel="self" type="application/rss+xml"/><item><title>Apps: forms</title><link>https://docs.communityhealthtoolkit.org/beta/apps/reference/forms/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://docs.communityhealthtoolkit.org/beta/apps/reference/forms/</guid><description/></item><item><title>Apps: resources</title><link>https://docs.communityhealthtoolkit.org/beta/apps/reference/resources/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://docs.communityhealthtoolkit.org/beta/apps/reference/resources/</guid><description>
&lt;h2 id="icons">Icons&lt;/h2>
&lt;p>Apps can be customized by defining the icons to use for tasks, targets, and contacts.&lt;/p>
&lt;p>Add icons to the &lt;code>resources&lt;/code> folder, and include them by name in the resources.json file.&lt;/p>
&lt;pre>&lt;code>{
&amp;quot;icon-risk&amp;quot;: &amp;quot;icon-healthcare-warning@2x.png&amp;quot;,
&amp;quot;icon-treatment&amp;quot;: &amp;quot;icon-healthcare-medicine@2x.png&amp;quot;,
&amp;quot;medic-clinic&amp;quot;: &amp;quot;medic-family.svg&amp;quot;,
&amp;quot;medic-district-hospital&amp;quot;: &amp;quot;medic-health-center.svg&amp;quot;,
&amp;quot;medic-health-center&amp;quot;: &amp;quot;medic-chw-area.svg&amp;quot;,
&amp;quot;medic-person&amp;quot;: &amp;quot;medic-person.svg&amp;quot;
}
&lt;/code>&lt;/pre>
&lt;p>&lt;em>See Also:&lt;/em> &lt;a href=https://docs.communityhealthtoolkit.org/beta/design/icons/#>Icon Library&lt;/a>&lt;/p>
&lt;h3 id="build">Build&lt;/h3>
&lt;p>Build the icons into the application with the &lt;code>upload-resources&lt;/code> action in &lt;code>medic-conf&lt;/code>.&lt;/p>
&lt;p>&lt;code>medic-conf --local upload-resources&lt;/code>&lt;/p>
&lt;h2 id="branding">Branding&lt;/h2>
&lt;p>The site title, favicon, and header logo are configurable. The location to change these are in the Admin console on the images page under the branding tab.&lt;/p>
&lt;h2 id="partner-logos">Partner logos&lt;/h2>
&lt;p>Adding your partner logos can be done in the Admin console on the images page under the Partners tab. This will add partner logos on the about page.&lt;/p></description></item><item><title>Apps: translations</title><link>https://docs.communityhealthtoolkit.org/beta/apps/reference/translations/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://docs.communityhealthtoolkit.org/beta/apps/reference/translations/</guid><description>
&lt;p>Given that CHT apps are used around the world, the Core Framework was designed with localization in mind. The Core Framework itself is available in English, French, Hindi, Nepali, Spanish, Swahili, and Indonesian. In the &lt;code>app_settings.json&lt;/code> file the default language for the application is set, along with a separate default language for outgoing messages that are sent via SMS.&lt;/p>
&lt;div class="alert alert-info" role="alert">
&lt;h4 class="alert-heading">Note&lt;/h4>
Please open &lt;a href="https://github.com/medic/cht-core/issues/new">an issue&lt;/a> if you are interested in translating the app into a different language, as we can work together to make that language available to the community.
&lt;/div>
&lt;h2 id="translations">Translations&lt;/h2>
&lt;p>To modify some labels in the app add the key and modified label in a custom translations file in the &lt;code>translations&lt;/code> folder. All the properties files use the format &lt;code>messages-{language-code}.properties&lt;/code>, where the language code is the same 2-letter code used to identify the language in the application. For instance, for English, we would have a &lt;code>translations/messages-en.properties&lt;/code> file.&lt;/p>
&lt;p>New elements in CHT apps, such as tasks, targets, profiles, and forms should be localized as well. These labels should be included in the same custom translations properties file. If a translation is missing for the user&amp;rsquo;s language it will use that of the default language.&lt;/p>
&lt;p>Here is an example, including both a modified label, and a new one:&lt;/p>
&lt;h3 id="translationsmessages-language-codeproperties">&lt;code>translations/messages-{language-code}.properties&lt;/code>&lt;/h3>
&lt;pre>&lt;code> [Application Text]
contact.type.district_hospital = Community
targets.assessments.title = Assessments Completed
&lt;/code>&lt;/pre>&lt;h2 id="forms">Forms&lt;/h2>
&lt;p>Translations for XForms are defined within the forms themselves. The XLSForm notation is &lt;a href="http://xlsform.org/en/#multiple-language-support">documented here&lt;/a>, and would use the corresponding 2-character language codes.&lt;/p>
&lt;h2 id="build">Build&lt;/h2>
&lt;p>Custom translations from the properties files are added to the app with the &lt;code>upload-custom-translations&lt;/code> action.&lt;/p>
&lt;p>&lt;code>medic-conf --local upload-custom-translations&lt;/code>&lt;/p>
&lt;p>Updated translations from forms need to be added with the actions to upload forms.&lt;/p>
&lt;p>&lt;code>medic-conf --local upload-contact-forms upload-app-forms&lt;/code>&lt;/p></description></item><item><title>Apps: app_settings.json</title><link>https://docs.communityhealthtoolkit.org/beta/apps/reference/app-settings/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://docs.communityhealthtoolkit.org/beta/apps/reference/app-settings/</guid><description>
&lt;p>The settings which control CHT apps are defined in the &lt;code>app_settings.json&lt;/code> file, and stored in the &lt;code>settings&lt;/code> doc in the database. Some settings can be modified in the &lt;a href="https://docs.communityhealthtoolkit.org/beta/apps/features/admin/">&lt;strong>App Management&lt;/strong>&lt;/a> app, which updates the same settings file in the database.&lt;/p>
&lt;p>The &lt;code>app_settings.json&lt;/code> file can be manually edited to modify individual settings. The code for some components, like tasks and targets, gets compiled into this file with the &lt;code>compile-app-settings&lt;/code> action in the &lt;code>medic-conf&lt;/code> tool.&lt;/p>
&lt;p>Most sections are described on their own in the &lt;a href="..">Reference Documentation&lt;/a>.&lt;/p>
&lt;h2 id="build">Build&lt;/h2>
&lt;p>To include your settings into your app, you must compile them to include modular components, then upload them to your instance.&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-sh" data-lang="sh">medic-conf --local compile-app-settings backup-app-settings upload-app-settings
&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="optional-settings">Optional Settings&lt;/h2>
&lt;p>The following settings do not need to be specified. They should only be defined when the default implementation needs to be changed.&lt;/p>
&lt;h3 id="app_settingsjson">&lt;code>app_settings.json&lt;/code>&lt;/h3>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>Setting&lt;/th>
&lt;th>Description&lt;/th>
&lt;th>Default&lt;/th>
&lt;th>Version&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>phone_validation&lt;/td>
&lt;td>&lt;ul>&lt;li>&amp;quot;full&amp;rdquo;: full validation of a phone number for a region using length and prefix information.&lt;/li>&lt;li>&amp;quot;partial&amp;rdquo;: quickly guesses whether a number is a possible phone number by using only the length information, much faster than a full validation.&lt;/li>&lt;li>&amp;quot;none&amp;rdquo;: allows almost any values but still fails for any phone that contains a-z chars.&lt;/li>&lt;/ul>&lt;/td>
&lt;td>&amp;ldquo;full&amp;rdquo;&lt;/td>
&lt;td>3.1.0&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>uhc.contacts_default_sort&lt;/td>
&lt;td>&lt;ul>&lt;li>&amp;quot;alpha&amp;rdquo;: Sort contacts alphanumerically&lt;/li>&lt;li>&amp;quot;last_visited_date&amp;rdquo;: sort contacts by the date they were most recently visited.&lt;/li>&lt;/ul>&lt;/td>
&lt;td>&amp;ldquo;alpha&amp;rdquo;&lt;/td>
&lt;td>2.18.0&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>uhc.visit_count.month_start_date&lt;/td>
&lt;td>The date of each month when the visit count is reset to 0.&lt;/td>
&lt;td>1&lt;/td>
&lt;td>2.18.0&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>uhc.visit_count.visit_count_goal&lt;/td>
&lt;td>The monthly visit count goal.&lt;/td>
&lt;td>0&lt;/td>
&lt;td>2.18.0&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>outgoing_deny_list&lt;/td>
&lt;td>All outgoing messages will be denied (unsent) if the recipient phone number starts with an entry in this list. A comma delimited list. (eg. &lt;code>outgoing_deny_list=&amp;quot;253,ORANGE&amp;quot;&lt;/code> will deny all messages sent to &lt;code>253 543 4448&lt;/code> and &lt;code>ORANGE NET&lt;/code>)&lt;/td>
&lt;td>&amp;quot;&amp;rdquo;&lt;/td>
&lt;td>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>outgoing_deny_shorter_than&lt;/td>
&lt;td>Deny all messages to recipient phone numbers which are shorter than this value. Intended to avoid &lt;a href="../troubleshooting/troubleshooting-quick-pointers.md#message-loops">message loops&lt;/a> with short codes used by gateways (eg. &lt;code>60396&lt;/code>). An integer.&lt;/td>
&lt;td>6&lt;/td>
&lt;td>3.3.0&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>outgoing_deny_with_alphas&lt;/td>
&lt;td>When &lt;code>true&lt;/code>, deny all messages to recipient phone numbers containing letters (eg. &lt;code>Safaricom&lt;/code>). Intended to avoid &lt;a href="../troubleshooting/troubleshooting-quick-pointers.md#message-loops">message loops&lt;/a> with non-numeric senders used by gateways. A boolean.&lt;/td>
&lt;td>true&lt;/td>
&lt;td>3.3.0&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>outgoing_deny_with_alphas&lt;/td>
&lt;td>When &lt;code>true&lt;/code>, deny all messages to recipient phone numbers containing letters (eg. &lt;code>Safaricom&lt;/code>). Intended to avoid &lt;a href="../troubleshooting/troubleshooting-quick-pointers.md#message-loops">message loops&lt;/a> with non-numeric senders used by gateways. A boolean.&lt;/td>
&lt;td>true&lt;/td>
&lt;td>3.3.0&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>task_day_limit&lt;/td>
&lt;td>The number of days before a task is due to show the due date.&lt;/td>
&lt;td>4&lt;/td>
&lt;td>3.9.0&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;h2 id="sms-workflows">SMS Workflows&lt;/h2>
&lt;p>Workflows involving SMS are configured by defining &lt;a href="https://docs.communityhealthtoolkit.org/beta/beta/apps/reference/app-settings/schedules/">schedules&lt;/a>, &lt;a href="https://docs.communityhealthtoolkit.org/beta/beta/apps/reference/app-settings/registrations/">registrations&lt;/a>, and &lt;a href="https://docs.communityhealthtoolkit.org/beta/beta/apps/reference/app-settings/patient_reports/">patient reports&lt;/a>. Schedules of automated messages can be sent from the server at specificied times in the future, and reports can be associated to contacts.Forms can also be configured to clear the schedule, or silence it for a period of time.&lt;/p>
&lt;h2 id="variables">Variables&lt;/h2>
&lt;p>Outgoing messages can use &lt;a href="https://mustache.github.io/mustache.5.html">Mustache templating&lt;/a> to insert variables and specify data formats.&lt;/p>
&lt;p>All the fields on the report doc are available as variables. Additionally, the &lt;code>contact&lt;/code> variable is the sender of the report.&lt;/p>
&lt;h3 id="code-sample">Code sample&lt;/h3>
&lt;p>The following translation label includes the &lt;code>name&lt;/code> field of &lt;code>contact&lt;/code>, along with the submitted &lt;code>patient_name&lt;/code> field, and the generated &lt;code>patient_id&lt;/code> field.&lt;/p>
&lt;h4 id="translationsmessages-enproperties">&lt;code>translations/messages-en.properties&lt;/code>&lt;/h4>
&lt;pre>&lt;code>messages.registration.report_accepted = Thank you {{contact.name}} for registering {{patient_name}}. Their ID is {{patient_id}}.
&lt;/code>&lt;/pre>&lt;h3 id="date-format-filters">Date Format Filters&lt;/h3>
&lt;p>The following filter functions are available for formating dates.&lt;/p>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>filter&lt;/th>
&lt;th>description&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>&lt;code>date&lt;/code>&lt;/td>
&lt;td>Displays dates according to the &lt;code>date_format&lt;/code> specified in app_settings. See &lt;a href="https://momentjs.com/docs/#/parsing/string-format/">doc for Moment.js format&lt;/a> for details.&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>datetime&lt;/code>&lt;/td>
&lt;td>Displays dates according to the &lt;code>reported_date_format&lt;/code> specified in app_settings. See &lt;a href="https://momentjs.com/docs/#/parsing/string-format/">doc for Moment.js format&lt;/a> for details.&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>bikram_sambat_date&lt;/code>&lt;/td>
&lt;td>Displays dates in Bikram Sambat calendar (most commonly used calendar in Nepal). Currently display format is hardcoded to e.g. &amp;ldquo;à¥§à¥« à¤šà¥ˆà¤¤ à¥¨à¥¦à¥­à¥©&amp;rdquo;.&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;h2 id="validations">Validations&lt;/h2>
&lt;p>Validation rules are code fragments used to determine if some input is valid. For example, to say a field is only valid if the value has at least five characters, you would use the lenMin(5). They are used in &lt;code>registrations[].validations.list[].rule&lt;/code> and &lt;code>patient_reports[].validations.list[].rule&lt;/code> to determine if an incoming report is accepted. A report is accepted as valid only if all rules return &lt;code>true&lt;/code>. If any validation rule returns &lt;code>false&lt;/code> then the report is marked as invalid, and a message is automatically sent to the submitter. The content for the message is set in the &lt;code>translation_key&lt;/code> associated to each rule. If a report fails multiple validations then each message will be sent. These can be combined into a single SMS by specifying &lt;code>&amp;quot;*.validations.join_responses&amp;quot; : true&lt;/code>.&lt;/p>
&lt;h3 id="operators">Operators&lt;/h3>
&lt;p>The available operators are:&lt;/p>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>Operator&lt;/th>
&lt;th>Description&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>&amp;amp;&amp;amp;&lt;/td>
&lt;td>and&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>||&lt;/td>
&lt;td>or&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>!&lt;/td>
&lt;td>not&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>a ? b : c&lt;/td>
&lt;td>ternary, ie: if &amp;lsquo;a&amp;rsquo; is true, then check &amp;lsquo;b&amp;rsquo;, otherwise check &amp;lsquo;c&amp;rsquo;&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>()&lt;/td>
&lt;td>nested blocks, eg: &amp;lsquo;a &amp;amp;&amp;amp; (b&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;h3 id="rules">Rules&lt;/h3>
&lt;p>Validation settings may consist of Pupil.js rules and rules specific to Medic Mobile.
These two types of rules cannot be combined as part of the same rule.&lt;/p>
&lt;p>Not OK:
&lt;code>rule: &amp;quot;regex(\d{5}) &amp;amp;&amp;amp; unique('patient_id')&amp;quot;&lt;/code>&lt;/p>
&lt;p>OK:
&lt;code>rule: &amp;quot;regex(\d{5}) &amp;amp;&amp;amp; max(11111)&amp;quot;&lt;/code>&lt;/p>
&lt;p>If for example you want to validate that patient_id is 5 numbers and it
is unique (or some other custom validation) you need to define two
validation configs/separate rules in your settings. Example validation
settings:&lt;/p>
&lt;pre>&lt;code>[
{
property: &amp;quot;patient_id&amp;quot;,
rule: &amp;quot;regex(\d{5})&amp;quot;,
message: [{
content: &amp;quot;Patient ID must be 5 numbers.&amp;quot;,
locale: &amp;quot;en&amp;quot;
}]
},
{
property: &amp;quot;patient_id&amp;quot;,
rule: &amp;quot;unique('patient_id')&amp;quot;,
message: [{
content: &amp;quot;Patient ID must be unique.&amp;quot;,
locale: &amp;quot;en&amp;quot;
}]
}
]
&lt;/code>&lt;/pre>&lt;p>&lt;code>validate()&lt;/code> modifies the property value of the second item to
&lt;code>patient_id_unique&lt;/code> so that pupil.validate() still returns a valid
result. Then we process the result once more to extract the custom
validation results and error messages.&lt;/p>
&lt;h4 id="pupiljs-validation-functions">Pupil.js validation functions&lt;/h4>
&lt;p>Available validation functions are available at &lt;a href="https://www.npmjs.com/package/pupil#validation-functions">https://www.npmjs.com/package/pupil#validation-functions&lt;/a>&lt;/p>
&lt;p>The following functions are available by default:&lt;/p>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>Function&lt;/th>
&lt;th>Description&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>&lt;code>equals&lt;/code>&lt;/td>
&lt;td>Comparison&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>iEquals&lt;/code>&lt;/td>
&lt;td>Case insensitive comparison&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>sEquals&lt;/code>&lt;/td>
&lt;td>Type sensitive equals&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>siEquals&lt;/code>&lt;/td>
&lt;td>Type sensitive case insensitive equals&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>lenMin&lt;/code>&lt;/td>
&lt;td>Minimum length&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>lenMax&lt;/code>&lt;/td>
&lt;td>Maximum length&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>lenEquals&lt;/code>&lt;/td>
&lt;td>Exact length&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>min&lt;/code>&lt;/td>
&lt;td>Minimum value&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>max&lt;/code>&lt;/td>
&lt;td>Maximum value&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>between&lt;/code>&lt;/td>
&lt;td>Minimum and maximum value&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>in&lt;/code>&lt;/td>
&lt;td>One of the provided values&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>required&lt;/code>&lt;/td>
&lt;td>Must have a value&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>optional&lt;/code>&lt;/td>
&lt;td>Always valid&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>numeric&lt;/code>&lt;/td>
&lt;td>Numbers only&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>integer&lt;/code>&lt;/td>
&lt;td>Integer numbers only&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>alpha&lt;/code>&lt;/td>
&lt;td>Letters only&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>alphaNumeric&lt;/code>&lt;/td>
&lt;td>Numbers and letters only&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>email&lt;/code>&lt;/td>
&lt;td>Email address format&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>regex&lt;/code>&lt;/td>
&lt;td>A custom regular expression&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>equalsTo&lt;/code>&lt;/td>
&lt;td>Compare to another field by its key&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;h5 id="sample-usage">Sample usage&lt;/h5>
&lt;p>For case-insensitive comparison &lt;code>iEquals&lt;/code> function in Pupil,
And you can use &lt;code>||&lt;/code> for logical OR : &lt;a href="https://www.npmjs.com/package/pupil#rule-strings">https://www.npmjs.com/package/pupil#rule-strings&lt;/a>&lt;/p>
&lt;p>So you can do this :
&lt;code>rule: 'iEquals(&amp;quot;mary&amp;quot;) || iEquals(&amp;quot;john&amp;quot;)'&lt;/code>
matches &amp;ldquo;mary&amp;rdquo;, &amp;ldquo;Mary&amp;rdquo;, &amp;ldquo;john&amp;rdquo;, &amp;ldquo;John&amp;rdquo;, &amp;ldquo;JOhN&amp;rdquo;, etc. Not &amp;ldquo;maryjohn&amp;rdquo;&lt;/p>
&lt;h4 id="cht-validation-functions">CHT validation functions&lt;/h4>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>Function&lt;/th>
&lt;th>Description&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>&lt;code>unique(*fields)&lt;/code>&lt;/td>
&lt;td>Returns &lt;code>true&lt;/code> if no existing valid report has the same value for all of the listed fields. Fields are compared to those at the top level and within &lt;code>fields&lt;/code> for every report doc. To include the form type use &lt;code>'form'&lt;/code> as one of the fields. Eg &lt;code>uniqueWithin('form', 'patient_id', '1 week')&lt;/code> checks that the same report wasn&amp;rsquo;t submitted for this patient in the past week.&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>uniqueWithin(*fields, time_period)&lt;/code>&lt;/td>
&lt;td>Same as &lt;code>unique&lt;/code> but the last argument is the time period in which to search. Eg &lt;code>uniqueWithin('form', 'patient_id')&lt;/code> checks that this report was never submitted for this patient.&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>exists(form_id, field)&lt;/code>&lt;/td>
&lt;td>Returns &lt;code>true&lt;/code> if a report matches the &lt;code>form_id&lt;/code> and value for &lt;code>field&lt;/code>. This is useful to check that a patient was registered for a service before reporting about it. Eg &lt;code>exists('REG', 'patient_id')&lt;/code> checks that a &lt;code>REG&lt;/code> form was already submitted for a patient. As of 2.12 most uses of this function are obsolete because checking for a valid &lt;code>patient_id&lt;/code> is done automatically by the &lt;code>accept_patient_report&lt;/code> transition using &lt;code>registration_not_found&lt;/code> in the &lt;code>messages.event_type&lt;/code>.&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>isISOWeek(weekFieldName[, yearFieldName])&lt;/code>&lt;/td>
&lt;td>Returns &lt;code>true&lt;/code> if the current report has a week value that is less or equal to the number of ISO weeks of the current year or the year value of the same report. The first parameter is the field name for the week and the second parameter is the field name for the year: &lt;code>isISOWeek('week', 'year')&lt;/code>. If the second parameter is not specified, then the current year is used: &lt;code>isISOWeek('week')&lt;/code>.&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table></description></item><item><title>Apps: contact-summary.templated.js</title><link>https://docs.communityhealthtoolkit.org/beta/apps/reference/contact-page/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://docs.communityhealthtoolkit.org/beta/apps/reference/contact-page/</guid><description>
&lt;p>Contact profile pages display basic information about the contact along with their history and upcoming tasks.
A contact&amp;rsquo;s profile page is defined by the &lt;a href="#contact-summary">Fields&lt;/a>, &lt;a href="#condition-cards">Cards&lt;/a>, and &lt;a href="#care-guides">Care Guides&lt;/a> available.&lt;/p>
&lt;p>Helper variables and functions for the contact summary can be defined in &lt;code>contact-summary-extras.js&lt;/code>. There are several variables available to inspect to generate the summary information:&lt;/p>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>Variable&lt;/th>
&lt;th>Description&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>&lt;code>contact&lt;/code>&lt;/td>
&lt;td>The currently selected contact. This has minimal stubs for the &lt;code>contact.parent&lt;/code>, so if you want to refer to a property on the parent use &lt;code>lineage&lt;/code> below.&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>reports&lt;/code>&lt;/td>
&lt;td>An array of reports for the contact.&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>lineage&lt;/code>&lt;/td>
&lt;td>An array of the contact&amp;rsquo;s parents (2.13+), eg &lt;code>lineage[0]&lt;/code> is the parent, &lt;code>lineage[1]&lt;/code> is the grandparent, etc. Each lineage entry has full information for the contact, so you can use &lt;code>lineage[1].contact.phone&lt;/code>.&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>targetDoc&lt;/code>&lt;/td>
&lt;td>Doc with &lt;a href="https://docs.communityhealthtoolkit.org/beta/core/overview/db-schema/#targets">&lt;code>target&lt;/code>&lt;/a> document of the contact, hydrated with the config information of every target it contains a value for. If there is no target document available (for example when viewing a contact that does not upload targets), this value will be &lt;code>undefined&lt;/code>. This value might also be &lt;code>undefined&lt;/code> if the contact has not yet synced the current target document. Added in &lt;code>3.9.0&lt;/code>.&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;h2 id="contact-summary">Contact Summary&lt;/h2>
&lt;p>Each field that can be shown on a contact&amp;rsquo;s profile is defined as an object in the &lt;code>fields&lt;/code> array of &lt;code>contact-summary.templated.js&lt;/code>. The properties for each object determine how and when the field is shown.&lt;/p>
&lt;h3 id="contact-summarytemplatedjs-fields">&lt;code>contact-summary.templated.js .fields[]&lt;/code>&lt;/h3>
&lt;!-- If you change this table, update the duplicate descriptions in ### Cards -->
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>property&lt;/th>
&lt;th>type&lt;/th>
&lt;th>description&lt;/th>
&lt;th>required&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>&lt;code>label&lt;/code>&lt;/td>
&lt;td>&lt;code>string&lt;/code>&lt;/td>
&lt;td>A translation key which is shown with the field.&lt;/td>
&lt;td>yes&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>icon&lt;/code>&lt;/td>
&lt;td>&lt;code>string&lt;/code>&lt;/td>
&lt;td>The name of the icon to display beside this field, as defined through the Configuration &amp;gt; Icons page.&lt;/td>
&lt;td>no&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>value&lt;/code>&lt;/td>
&lt;td>&lt;code>string&lt;/code>&lt;/td>
&lt;td>The value shown for the field.&lt;/td>
&lt;td>yes&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>filter&lt;/code>&lt;/td>
&lt;td>&lt;code>string&lt;/code>&lt;/td>
&lt;td>The display filter to apply to the value, eg: &lt;code>{ value: '2005-10-09', filter: 'age' }&lt;/code> will render as &amp;ldquo;11 years&amp;rdquo;. Common filters are: &lt;code>age&lt;/code>, &lt;code>phone&lt;/code>, &lt;code>weeksPregnant&lt;/code>, &lt;code>relativeDate&lt;/code>, &lt;code>relativeDay&lt;/code>, &lt;code>fullDate&lt;/code>, &lt;code>simpleDate&lt;/code>, &lt;code>simpleDateTime&lt;/code>, &lt;code>lineage&lt;/code>, &lt;code>resourceIcon&lt;/code>, &lt;code>translate&lt;/code>. For the complete list of filters, and more details on what each does, check out the code in &lt;a href="https://github.com/medic/medic/tree/master/webapp/src/js/filters">&lt;code>medic/webapp/src/js/filters&lt;/code> dir&lt;/a>.&lt;/td>
&lt;td>no&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>width&lt;/code>&lt;/td>
&lt;td>&lt;code>integer&lt;/code>&lt;/td>
&lt;td>The horizontal space for the field. Common values are 12 for full width, 6 for half width, or 3 for quarter width. Default 12.&lt;/td>
&lt;td>no&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>translate&lt;/code>&lt;/td>
&lt;td>&lt;code>boolean&lt;/code>&lt;/td>
&lt;td>Whether or not to translate the &lt;code>value&lt;/code>. Defaults to false.&lt;/td>
&lt;td>no&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>context&lt;/code>&lt;/td>
&lt;td>&lt;code>object&lt;/code>&lt;/td>
&lt;td>When &lt;code>translate: true&lt;/code> and &lt;code>value&lt;/code> uses &lt;a href="https://angular-translate.github.io/docs/#/guide/06_variable-replacement">translation variables&lt;/a>, this value should provide the translation variables.&lt;/td>
&lt;td>no&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>appliesIf&lt;/code>&lt;/td>
&lt;td>&lt;code>function()&lt;/code> or &lt;code>boolean&lt;/code>&lt;/td>
&lt;td>Return true if the field should be shown.&lt;/td>
&lt;td>no&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>appliesToType&lt;/code>&lt;/td>
&lt;td>&lt;code>string[]&lt;/code>&lt;/td>
&lt;td>Filters the contacts for which &lt;code>appliesIf&lt;/code> will be evaluated. For example, &lt;code>['person']&lt;/code> or &lt;code>['clinic', 'health_center']&lt;/code>.&lt;/td>
&lt;td>no&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;!-- TODO: See [How to configure profile pages]() for an example. -->
&lt;h2 id="condition-cards">Condition Cards&lt;/h2>
&lt;p>Each condition card is defined as a card object in the &lt;code>cards&lt;/code> array of &lt;code>contact-summary.templated.js&lt;/code>. The properties for each object determine how and when the card and its fields are shown.&lt;/p>
&lt;h3 id="contact-summarytemplatedjs-cards">&lt;code>contact-summary.templated.js .cards[]&lt;/code>&lt;/h3>
&lt;!-- If you change the field data in this table, update the duplicate descriptions in ### Fields -->
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>property&lt;/th>
&lt;th>type&lt;/th>
&lt;th>description&lt;/th>
&lt;th>required&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>&lt;code>label&lt;/code>&lt;/td>
&lt;td>&lt;code>translation key&lt;/code>&lt;/td>
&lt;td>Label on top of card.&lt;/td>
&lt;td>yes&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>appliesToType&lt;/code>&lt;/td>
&lt;td>&lt;code>string[]&lt;/code>&lt;/td>
&lt;td>A filter, so &lt;code>appliesIf&lt;/code> is called only if the contact&amp;rsquo;s type matches one or more of the elements. For example, &lt;code>['person']&lt;/code>. Please, note that &lt;code>['report']&lt;/code> is also allowed to create a report card. But, you cannot use it in conjunction with a contact&amp;rsquo;s type.&lt;/td>
&lt;td>no&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>appliesIf&lt;/code>&lt;/td>
&lt;td>&lt;code>function()&lt;/code> or &lt;code>boolean&lt;/code>&lt;/td>
&lt;td>Return true if the field should be shown.&lt;/td>
&lt;td>no&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>modifyContext&lt;/code>&lt;/td>
&lt;td>&lt;code>function(context)&lt;/code>&lt;/td>
&lt;td>Used to modify or add data which is passed as input to forms filled from the contact page.&lt;/td>
&lt;td>no&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>fields&lt;/code>&lt;/td>
&lt;td>&lt;code>Array[]&lt;/code> of &lt;a href="#fields">fields&lt;/a>&lt;/td>
&lt;td>The content of the card.&lt;/td>
&lt;td>yes&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>fields[n].appliesIf&lt;/code>&lt;/td>
&lt;td>&lt;code>boolean&lt;/code> or &lt;code>function(report)&lt;/code>&lt;/td>
&lt;td>Same as Fields.appliesIf above.&lt;/td>
&lt;td>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>fields[n].label&lt;/code>&lt;/td>
&lt;td>&lt;code>string&lt;/code> or &lt;code>function(report)&lt;/code>&lt;/td>
&lt;td>Label shown with the field.&lt;/td>
&lt;td>yes&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>fields[n].icon&lt;/code>&lt;/td>
&lt;td>&lt;code>string&lt;/code> or &lt;code>function(report)&lt;/code>&lt;/td>
&lt;td>The name of the icon to display beside this field, as defined through the Configuration &amp;gt; Icons page.&lt;/td>
&lt;td>no&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>fields[n].value&lt;/code>&lt;/td>
&lt;td>&lt;code>string&lt;/code> or &lt;code>function(report)&lt;/code>&lt;/td>
&lt;td>The value shown for the field.&lt;/td>
&lt;td>yes&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>fields[n].filter&lt;/code>&lt;/td>
&lt;td>&lt;code>string&lt;/code> or &lt;code>function(report)&lt;/code>&lt;/td>
&lt;td>The display filter to apply to the value, eg: &lt;code>{ value: '2005-10-09', filter: 'age' }&lt;/code> will render as &amp;ldquo;11 years&amp;rdquo;. Common filters are: &lt;code>age&lt;/code>, &lt;code>phone&lt;/code>, &lt;code>weeksPregnant&lt;/code>, &lt;code>relativeDate&lt;/code>, &lt;code>relativeDay&lt;/code>, &lt;code>fullDate&lt;/code>, &lt;code>simpleDate&lt;/code>, &lt;code>simpleDateTime&lt;/code>, &lt;code>lineage&lt;/code>, &lt;code>resourceIcon&lt;/code>, &lt;code>translate&lt;/code>. For the complete list of filters, and more details on what each does, check out the code in &lt;a href="https://github.com/medic/medic/tree/master/webapp/src/js/filters">&lt;code>medic/webapp/src/js/filters&lt;/code> dir&lt;/a>.&lt;/td>
&lt;td>no&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>fields[n].width&lt;/code>&lt;/td>
&lt;td>&lt;code>integer&lt;/code> or &lt;code>function(report)&lt;/code>&lt;/td>
&lt;td>The horizontal space for the field. Common values are 12 for full width, 6 for half width, or 3 for quarter width. Default 12.&lt;/td>
&lt;td>no&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>fields[n].translate&lt;/code>&lt;/td>
&lt;td>&lt;code>boolean&lt;/code> or &lt;code>function(report)&lt;/code>&lt;/td>
&lt;td>Whether or not to translate the &lt;code>value&lt;/code>. Defaults to false.&lt;/td>
&lt;td>no&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>fields[n].context&lt;/code>&lt;/td>
&lt;td>&lt;code>object&lt;/code>&lt;/td>
&lt;td>When &lt;code>translate: true&lt;/code> and &lt;code>value&lt;/code> uses &lt;a href="https://angular-translate.github.io/docs/#/guide/06_variable-replacement">translation variables&lt;/a>, this value should provide the translation variables. Only supports properties &lt;code>count&lt;/code> and &lt;code>total&lt;/code> on cards.&lt;/td>
&lt;td>no&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;!-- TODO: See [How to configure profile pages]() for an example. -->
&lt;h2 id="care-guides">Care Guides&lt;/h2>
&lt;p>Each care guide accessible from a contact profile is defined as an &lt;a href="https://docs.communityhealthtoolkit.org/beta/apps/reference/forms/app/">App Form&lt;/a>. Context information can be provided to forms via the &lt;code>context&lt;/code> object of &lt;code>contact-summary.templated.js&lt;/code>.&lt;/p>
&lt;p>To show an App Form on a contact&amp;rsquo;s profile, the form&amp;rsquo;s &lt;code>expression&lt;/code> field in its properties file must evaluate to true for that contact. The context infomation from the profile is accessible as the variable &lt;code>summary&lt;/code>.&lt;/p>
&lt;p>The context data is also available directly within the app forms&amp;rsquo; XForm calculations, as &lt;code>instance('contact-summary')/context/${variable}&lt;/code>. For instance if &lt;code>context.is_pregnant&lt;/code> is used in the contact summary, it can be accessed in an XForm field&amp;rsquo;s calculation as &lt;code>instance('contact-summary')/context/is_pregnant&lt;/code>. Note that these fields are not available when editing a previously completed form, or when accessing the form from outside of the profile page.&lt;/p>
&lt;!-- TODO: See [How to configure profile pages]() and [How to build app forms]() for examples and more information. -->
&lt;h2 id="code-samples">Code samples&lt;/h2>
&lt;p>The following samples show how fields, cards, and care guide context comes together in the &lt;code>contact-summary.templated.js&lt;/code> file.&lt;/p>
&lt;h3 id="contact-summarytemplatedjs">&lt;code>contact-summary.templated.js&lt;/code>&lt;/h3>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-js" data-lang="js">&lt;span style="color:#000">module&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">exports&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span> &lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;span style="color:#000">context&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span> &lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;span style="color:#000">use_cases&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span> &lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;span style="color:#000">anc&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span> &lt;span style="color:#000">isCoveredByUseCaseInLineage&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">lineage&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#4e9a06">&amp;#39;anc&amp;#39;&lt;/span>&lt;span style="color:#000;font-weight:bold">),&lt;/span>
&lt;span style="color:#000">pnc&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span> &lt;span style="color:#000">isCoveredByUseCaseInLineage&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">lineage&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#4e9a06">&amp;#39;pnc&amp;#39;&lt;/span>&lt;span style="color:#000;font-weight:bold">),&lt;/span>
&lt;span style="color:#000;font-weight:bold">},&lt;/span>
&lt;span style="color:#000;font-weight:bold">},&lt;/span>
&lt;span style="color:#000">fields&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span> &lt;span style="color:#000;font-weight:bold">[&lt;/span>
&lt;span style="color:#000;font-weight:bold">{&lt;/span> &lt;span style="color:#000">appliesToType&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span>&lt;span style="color:#4e9a06">&amp;#39;person&amp;#39;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">label&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span>&lt;span style="color:#4e9a06">&amp;#39;patient_id&amp;#39;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">value&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span>&lt;span style="color:#000">contact&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">patient_id&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">width&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span> &lt;span style="color:#0000cf;font-weight:bold">4&lt;/span> &lt;span style="color:#000;font-weight:bold">},&lt;/span>
&lt;span style="color:#000;font-weight:bold">{&lt;/span> &lt;span style="color:#000">appliesToType&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span>&lt;span style="color:#4e9a06">&amp;#39;person&amp;#39;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">label&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span>&lt;span style="color:#4e9a06">&amp;#39;contact.age&amp;#39;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">value&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span>&lt;span style="color:#000">contact&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">date_of_birth&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">width&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span> &lt;span style="color:#0000cf;font-weight:bold">4&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">filter&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span> &lt;span style="color:#4e9a06">&amp;#39;age&amp;#39;&lt;/span> &lt;span style="color:#000;font-weight:bold">},&lt;/span>
&lt;span style="color:#000;font-weight:bold">{&lt;/span> &lt;span style="color:#000">appliesToType&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span>&lt;span style="color:#4e9a06">&amp;#39;person&amp;#39;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">label&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span>&lt;span style="color:#4e9a06">&amp;#39;contact.parent&amp;#39;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">value&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span>&lt;span style="color:#000">lineage&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">filter&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span> &lt;span style="color:#4e9a06">&amp;#39;lineage&amp;#39;&lt;/span> &lt;span style="color:#000;font-weight:bold">},&lt;/span>
&lt;span style="color:#000;font-weight:bold">{&lt;/span> &lt;span style="color:#000">appliesToType&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span>&lt;span style="color:#4e9a06">&amp;#39;!person&amp;#39;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">appliesIf&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span>&lt;span style="color:#204a87;font-weight:bold">function&lt;/span>&lt;span style="color:#000;font-weight:bold">()&lt;/span> &lt;span style="color:#000;font-weight:bold">{&lt;/span> &lt;span style="color:#204a87;font-weight:bold">return&lt;/span> &lt;span style="color:#000">contact&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">parent&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">&amp;amp;&amp;amp;&lt;/span> &lt;span style="color:#000">lineage&lt;/span>&lt;span style="color:#000;font-weight:bold">[&lt;/span>&lt;span style="color:#0000cf;font-weight:bold">0&lt;/span>&lt;span style="color:#000;font-weight:bold">];&lt;/span> &lt;span style="color:#000;font-weight:bold">},&lt;/span> &lt;span style="color:#000">label&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span>&lt;span style="color:#4e9a06">&amp;#39;contact.parent&amp;#39;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">value&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span>&lt;span style="color:#000">lineage&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">filter&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span>&lt;span style="color:#4e9a06">&amp;#39;lineage&amp;#39;&lt;/span> &lt;span style="color:#000;font-weight:bold">},&lt;/span>
&lt;span style="color:#000;font-weight:bold">],&lt;/span>
&lt;span style="color:#000">cards&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span> &lt;span style="color:#000;font-weight:bold">[&lt;/span>
&lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;span style="color:#000">label&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span> &lt;span style="color:#4e9a06">&amp;#39;contact.profile.pregnancy&amp;#39;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;span style="color:#000">appliesToType&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span> &lt;span style="color:#4e9a06">&amp;#39;report&amp;#39;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;span style="color:#000">appliesIf&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span> &lt;span style="color:#000">extras&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">isActivePregnancy&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;span style="color:#000">fields&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span> &lt;span style="color:#000;font-weight:bold">[&lt;/span>
&lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;span style="color:#000">label&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span> &lt;span style="color:#4e9a06">&amp;#39;contact.profile.edd&amp;#39;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;span style="color:#000">value&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span> &lt;span style="color:#204a87;font-weight:bold">function&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">r&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span> &lt;span style="color:#000;font-weight:bold">{&lt;/span> &lt;span style="color:#204a87;font-weight:bold">return&lt;/span> &lt;span style="color:#000">r&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">fields&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">edd_8601&lt;/span>&lt;span style="color:#000;font-weight:bold">;&lt;/span> &lt;span style="color:#000;font-weight:bold">},&lt;/span>
&lt;span style="color:#000">filter&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span> &lt;span style="color:#4e9a06">&amp;#39;relativeDay&amp;#39;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;span style="color:#000">width&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span> &lt;span style="color:#0000cf;font-weight:bold">12&lt;/span>
&lt;span style="color:#000;font-weight:bold">},&lt;/span>
&lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;span style="color:#000">label&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span> &lt;span style="color:#4e9a06">&amp;#39;contact.profile.visit&amp;#39;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;span style="color:#000">value&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span> &lt;span style="color:#4e9a06">&amp;#39;contact.profile.visits.of&amp;#39;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;span style="color:#000">translate&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span> &lt;span style="color:#204a87;font-weight:bold">true&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;span style="color:#000">context&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span> &lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;span style="color:#000">count&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span> &lt;span style="color:#204a87;font-weight:bold">function&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">r&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span> &lt;span style="color:#000;font-weight:bold">{&lt;/span> &lt;span style="color:#204a87;font-weight:bold">return&lt;/span> &lt;span style="color:#000">extras&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">getSubsequentVisits&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">r&lt;/span>&lt;span style="color:#000;font-weight:bold">).&lt;/span>&lt;span style="color:#000">length&lt;/span>&lt;span style="color:#000;font-weight:bold">;&lt;/span> &lt;span style="color:#000;font-weight:bold">},&lt;/span>
&lt;span style="color:#000">total&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span> &lt;span style="color:#0000cf;font-weight:bold">4&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;span style="color:#000;font-weight:bold">},&lt;/span>
&lt;span style="color:#000">width&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span> &lt;span style="color:#0000cf;font-weight:bold">6&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;span style="color:#000;font-weight:bold">},&lt;/span>
&lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;span style="color:#000">label&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span> &lt;span style="color:#4e9a06">&amp;#39;contact.profile.risk.title&amp;#39;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;span style="color:#000">value&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span> &lt;span style="color:#204a87;font-weight:bold">function&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">r&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span> &lt;span style="color:#000;font-weight:bold">{&lt;/span> &lt;span style="color:#204a87;font-weight:bold">return&lt;/span> &lt;span style="color:#000">extras&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">isHighRiskPregnancy&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">r&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">?&lt;/span> &lt;span style="color:#4e9a06">&amp;#39;high&amp;#39;&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span>&lt;span style="color:#4e9a06">&amp;#39;normal&amp;#39;&lt;/span>&lt;span style="color:#000;font-weight:bold">;&lt;/span>
&lt;span style="color:#000;font-weight:bold">},&lt;/span>
&lt;span style="color:#000">translate&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span> &lt;span style="color:#204a87;font-weight:bold">true&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;span style="color:#000">width&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span> &lt;span style="color:#0000cf;font-weight:bold">5&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;span style="color:#000">icon&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span> &lt;span style="color:#204a87;font-weight:bold">function&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">r&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span> &lt;span style="color:#000;font-weight:bold">{&lt;/span> &lt;span style="color:#204a87;font-weight:bold">return&lt;/span> &lt;span style="color:#000">extras&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">isHighRiskPregnancy&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">r&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">?&lt;/span> &lt;span style="color:#4e9a06">&amp;#39;risk&amp;#39;&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span> &lt;span style="color:#4e9a06">&amp;#39;&amp;#39;&lt;/span>&lt;span style="color:#000;font-weight:bold">;&lt;/span> &lt;span style="color:#000;font-weight:bold">},&lt;/span>
&lt;span style="color:#000;font-weight:bold">},&lt;/span>
&lt;span style="color:#000;font-weight:bold">],&lt;/span>
&lt;span style="color:#000">modifyContext&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span> &lt;span style="color:#204a87;font-weight:bold">function&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">ctx&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span> &lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;span style="color:#000">ctx&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">pregnant&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span> &lt;span style="color:#204a87;font-weight:bold">true&lt;/span>&lt;span style="color:#000;font-weight:bold">;&lt;/span> &lt;span style="color:#8f5902;font-style:italic">// don&amp;#39;t show Create Pregnancy Report button
&lt;/span>&lt;span style="color:#8f5902;font-style:italic">&lt;/span> &lt;span style="color:#000;font-weight:bold">},&lt;/span>
&lt;span style="color:#000;font-weight:bold">},&lt;/span>
&lt;span style="color:#000;font-weight:bold">],&lt;/span>
&lt;span style="color:#000;font-weight:bold">};&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="contact-summary-extrasjs">&lt;code>contact-summary-extras.js&lt;/code>&lt;/h3>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-js" data-lang="js">&lt;span style="color:#000">module&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">exports&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span> &lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;span style="color:#000">isActivePregnancy&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span> &lt;span style="color:#204a87;font-weight:bold">function&lt;/span> &lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">r&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span> &lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;span style="color:#8f5902;font-style:italic">// ...
&lt;/span>&lt;span style="color:#8f5902;font-style:italic">&lt;/span> &lt;span style="color:#000;font-weight:bold">},&lt;/span>
&lt;span style="color:#000">isCoveredByUseCaseInLineage&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span> &lt;span style="color:#204a87;font-weight:bold">function&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">lineage&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">usecase&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span> &lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;span style="color:#8f5902;font-style:italic">// ...
&lt;/span>&lt;span style="color:#8f5902;font-style:italic">&lt;/span> &lt;span style="color:#000;font-weight:bold">},&lt;/span>
&lt;span style="color:#000">isHighRiskPregnancy&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span> &lt;span style="color:#204a87;font-weight:bold">function&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">pregnancy&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span> &lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;span style="color:#8f5902;font-style:italic">// ...
&lt;/span>&lt;span style="color:#8f5902;font-style:italic">&lt;/span> &lt;span style="color:#000;font-weight:bold">},&lt;/span>
&lt;span style="color:#000">getSubsequentVisits&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span> &lt;span style="color:#204a87;font-weight:bold">function&lt;/span> &lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">r&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span> &lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;span style="color:#8f5902;font-style:italic">// ...
&lt;/span>&lt;span style="color:#8f5902;font-style:italic">&lt;/span> &lt;span style="color:#000;font-weight:bold">},&lt;/span>
&lt;span style="color:#000;font-weight:bold">};&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="build">Build&lt;/h2>
&lt;p>To update the Contact profiles for an app, changes must be compiled into &lt;code>app-settings&lt;/code>, then uploaded.&lt;/p>
&lt;p>&lt;code>medic-conf --local compile-app-settings backup-app-settings upload-app-settings&lt;/code>&lt;/p></description></item><item><title>Apps: targets.js</title><link>https://docs.communityhealthtoolkit.org/beta/apps/reference/targets/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://docs.communityhealthtoolkit.org/beta/apps/reference/targets/</guid><description>
&lt;p>&lt;img src="counts.png" alt="Percentages">&lt;/p>
&lt;p>&lt;img src="percentages.png" alt="Percentages">&lt;/p>
&lt;p>All targets are defined in the &lt;code>targets.js&lt;/code> file as an array of objects according to the Targets schema defined below. Each object corresponds to a target widget that shows in the app. The order of objects in the array defines the display order of widgets on the Targets tab. The properties of the object are used to define when the target should appear, what it should look like, and the values it will display.&lt;/p>
&lt;p>&lt;em>See Also:&lt;/em> &lt;a href=https://docs.communityhealthtoolkit.org/beta/apps/features/targets/#>Targets Overview&lt;/a>&lt;/p>
&lt;h2 id="targetsjs">&lt;code>targets.js&lt;/code>&lt;/h2>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>property&lt;/th>
&lt;th>type&lt;/th>
&lt;th>description&lt;/th>
&lt;th>required&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>&lt;code>id&lt;/code>&lt;/td>
&lt;td>&lt;code>string&lt;/code>&lt;/td>
&lt;td>An identifier for the target. Used for querying task completeness.&lt;/td>
&lt;td>yes, unique&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>icon&lt;/code>&lt;/td>
&lt;td>&lt;code>string&lt;/code>&lt;/td>
&lt;td>The icon to show alongside the task. Should correspond with a value defined in &lt;code>resources.json&lt;/code>.&lt;/td>
&lt;td>no&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>translation_key&lt;/code>&lt;/td>
&lt;td>&lt;code>translation key&lt;/code>&lt;/td>
&lt;td>Translation key for the title of this target.&lt;/td>
&lt;td>no, but recommended&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>subtitle_translation_key&lt;/code>&lt;/td>
&lt;td>&lt;code>translation key&lt;/code>&lt;/td>
&lt;td>Translation key for the subtitle of this target. If none supplied the subtitle will be blank.&lt;/td>
&lt;td>no&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>percentage_count_translation_key&lt;/code>&lt;/td>
&lt;td>&lt;code>translation key&lt;/code>&lt;/td>
&lt;td>Translation key for the percentage value detail shown at the bottom of the target, eg &amp;ldquo;(5 of 6 deliveries)&amp;quot;. The translation context has &lt;code>pass&lt;/code> and &lt;code>total&lt;/code> variables available. If none supplied this defaults to &lt;code>targets.count.default&lt;/code>.&lt;/td>
&lt;td>no&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>context&lt;/code>&lt;/td>
&lt;td>&lt;code>string&lt;/code>&lt;/td>
&lt;td>A string containing a JavaScript expression. This widget will only be shown if the expression evaluates to true. Details of the current user is available through the variable &lt;code>user&lt;/code>.&lt;/td>
&lt;td>no&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>type&lt;/code>&lt;/td>
&lt;td>&lt;code>'count'&lt;/code> or &lt;code>'percent'&lt;/code>&lt;/td>
&lt;td>The type of the widget.&lt;/td>
&lt;td>yes&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>goal&lt;/code>&lt;/td>
&lt;td>&lt;code>integer&lt;/code>&lt;/td>
&lt;td>For targets with &lt;code>type: 'percent'&lt;/code>, an integer from 0 to 100. For &lt;code>type: 'count'&lt;/code>, any positive number. If there is no goal, put -1.&lt;/td>
&lt;td>yes&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>appliesTo&lt;/code>&lt;/td>
&lt;td>&lt;code>'contacts'&lt;/code> or &lt;code>'reports'&lt;/code>&lt;/td>
&lt;td>Do you want to count reports or contacts? This attribute controls the behavior of other attributes herein.&lt;/td>
&lt;td>yes&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>appliesToType&lt;/code>&lt;/td>
&lt;td>If &lt;code>appliesTo: 'reports'&lt;/code>, an array of form codes. If &lt;code>appliesTo: 'contacts'&lt;/code>, an array of contact types.&lt;/td>
&lt;td>Filters the contacts or reports for which &lt;code>appliesIf&lt;/code> will be evaluated. For example, &lt;code>['person']&lt;/code> or &lt;code>['clinic', 'health_center']&lt;/code>. For example, &lt;code>['pregnancy']&lt;/code> or &lt;code>['P', 'pregnancy']&lt;/code>.&lt;/td>
&lt;td>no&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>appliesIf&lt;/code>&lt;/td>
&lt;td>&lt;code>function(contact, report)&lt;/code>&lt;/td>
&lt;td>If &lt;code>appliesTo: 'contacts'&lt;/code>, this function is invoked once per contact and &lt;code>report&lt;/code> is undefined. If &lt;code>appliesTo: 'reports'&lt;/code>, this function is invoked once per report. Return true to count this document. For &lt;code>type: 'percent'&lt;/code>, this controls the denominator.&lt;/td>
&lt;td>no&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>passesIf&lt;/code>&lt;/td>
&lt;td>&lt;code>function(contact, report)&lt;/code>&lt;/td>
&lt;td>For &lt;code>type: 'percent'&lt;/code>, return true to increment the numerator.&lt;/td>
&lt;td>yes, if &lt;code>type: 'percent'&lt;/code>. Forbidden when &lt;code>groupBy&lt;/code> is defined.&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>date&lt;/code>&lt;/td>
&lt;td>&lt;code>'reported'&lt;/code> or &lt;code>'now'&lt;/code> or &lt;code>function(contact, report)&lt;/code>&lt;/td>
&lt;td>When &lt;code>'reported'&lt;/code>, the target will count documents with a &lt;code>reported_date&lt;/code> within the current month. When &lt;code>'now'&lt;/code>, target includes all documents. A function can be used to indicate when the document should be counted. Default is &lt;code>'reported'&lt;/code>.&lt;/td>
&lt;td>no&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>idType&lt;/code>&lt;/td>
&lt;td>&lt;code>'report'&lt;/code> or &lt;code>'contact'&lt;/code> or &lt;code>function(contact, report)&lt;/code>&lt;/td>
&lt;td>The target&amp;rsquo;s values are incremented once per unique ID. To count individual contacts that have one or more reports that apply, use &lt;code>'contact'&lt;/code>. Use &lt;code>'report'&lt;/code> to count all reports, even if there are multiple that apply for a single contact. If you need more than a single count for each applying contact or report then a custom function can be used returning an array with unique IDs â€” one element for each count.&lt;/td>
&lt;td>no&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>groupBy&lt;/code>&lt;/td>
&lt;td>&lt;code>function(contact, report)&lt;/code> returning string&lt;/td>
&lt;td>Allows for target ids to be aggregated and scored in groups. Not required for most targets. Use with passesIfGroupCount.&lt;/td>
&lt;td>no&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>passesIfGroupCount&lt;/code>&lt;/td>
&lt;td>&lt;code>object&lt;/code>&lt;/td>
&lt;td>The criteria to determine if the target ids within a group should be counted as passing&lt;/td>
&lt;td>yes when &lt;code>groupBy&lt;/code> is defined&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>passesIfGroupCount.gte&lt;/code>&lt;/td>
&lt;td>&lt;code>number&lt;/code>&lt;/td>
&lt;td>The group should be counted as passing if the number of target ids in the group is greater-than-or-equal-to this value&lt;/td>
&lt;td>yes when &lt;code>groupBy&lt;/code> is defined&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>dhis&lt;/code>&lt;/td>
&lt;td>&lt;code>object&lt;/code> or &lt;code>object[]&lt;/code>&lt;/td>
&lt;td>Settings relevant to the &lt;a href="https://docs.communityhealthtoolkit.org/beta/apps/guides/integrations/dhis2-aggregate/#configuration">DHIS2 Integration&lt;/a>&lt;/td>
&lt;td>no&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>dhis[n].dataElement&lt;/code>&lt;/td>
&lt;td>&lt;code>string&lt;/code>&lt;/td>
&lt;td>The hash id of a data element configured in the DHIS2 data set you&amp;rsquo;re integrating with&lt;/td>
&lt;td>yes&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>dhis[n].dataSet&lt;/code>&lt;/td>
&lt;td>&lt;code>string&lt;/code>&lt;/td>
&lt;td>The hash id of the data set that contains the data element you&amp;rsquo;re integrating with. If this is left undefined, the data element will appear in all data sets.&lt;/td>
&lt;td>no&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>visible&lt;/code>&lt;/td>
&lt;td>&lt;code>boolean&lt;/code>&lt;/td>
&lt;td>Whether the target is visible in the targets page. &lt;strong>Default: true&lt;/strong>&lt;/td>
&lt;td>no&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>aggregate&lt;/code>&lt;/td>
&lt;td>&lt;code>boolean&lt;/code>&lt;/td>
&lt;td>As of 3.9, defines whether the target will be displayed on the TargetAggregates page&lt;/td>
&lt;td>no&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;h2 id="utils">Utils&lt;/h2>
&lt;p>Utility functions in the Core Framework can make common tasks much easier. These are available only for Tasks and Targets. To use the function call &lt;code>Utils.&amp;lt;function-name&amp;gt;(&amp;lt;params&amp;gt;)&lt;/code>, for example &lt;code>Utils.addDate(report.reported_date, 10)&lt;/code>.&lt;/p>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>Name&lt;/th>
&lt;th>Description&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>&lt;code>isTimely(date, event)&lt;/code>&lt;/td>
&lt;td>Returns true if the given date is after the start date and before the end date of the event.&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>addDate(date, days)&lt;/code>&lt;/td>
&lt;td>Returns a new Date set to midnight the given number of days after the given date. If no date is given the date defaults to today.&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>getLmpDate(doc)&lt;/code>&lt;/td>
&lt;td>Attempts to work out the LMP from the given doc. If no LMP is given it defaults to four weeks before the reported_date.&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>getSchedule(name)&lt;/code>&lt;/td>
&lt;td>Returns the task schedule with the given name from the configuration.&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>getMostRecentTimestamp(reports, form)&lt;/code>&lt;/td>
&lt;td>Returns the reported_date of the most recent of the reports with form ID matching the given form.&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>getMostRecentReport(reports, form)&lt;/code>&lt;/td>
&lt;td>Like &lt;code>getMostRecentTimestamp&lt;/code> but returns the report, not just the reported_date.&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>isFormSubmittedInWindow(reports, form, start, end)&lt;/code>&lt;/td>
&lt;td>Returns true if any of the given reports are for the given form and were reported after start and before end.&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>isFirstReportNewer(firstReport, secondReport)&lt;/code>&lt;/td>
&lt;td>Returns true if the firstReport was reported before the secondReport.&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>isDateValid(date)&lt;/code>&lt;/td>
&lt;td>Returns true if the given date is a validate JavaScript Date.&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>now()&lt;/code>&lt;/td>
&lt;td>Returns the current Date.&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>MS_IN_DAY&lt;/code>&lt;/td>
&lt;td>A constant for the number of milliseconds in a day.&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;p>Please open &lt;a href="https://github.com/medic/cht-core/issues/new">an issue&lt;/a> if you&amp;rsquo;d like other functions included.&lt;/p>
&lt;h2 id="nools-extras">Nools Extras&lt;/h2>
&lt;p>Helper variables and functions can be defined in &lt;code>nools-extras.js&lt;/code>, which is shared by both &lt;code>tasks.js&lt;/code> and &lt;code>targets.js&lt;/code>. The following are global variables that can be used:&lt;/p>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>Variable&lt;/th>
&lt;th>Description&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>&lt;code>c.contact&lt;/code>&lt;/td>
&lt;td>The contact&amp;rsquo;s doc. All contacts have &lt;code>type&lt;/code> of either &lt;code>person&lt;/code> or &lt;code>place&lt;/code>.&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>c.reports&lt;/code>&lt;/td>
&lt;td>An array of all the reports submitted about the contact.&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>console&lt;/code>&lt;/td>
&lt;td>Useful for outputting &lt;em>debugging&lt;/em> statements. Should not be used in production code.&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>Utils&lt;/code>&lt;/td>
&lt;td>Useful functions across projects are available, and describe in the Utils section.&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;h2 id="code-samples">Code Samples&lt;/h2>
&lt;p>This sample &lt;code>targets.js&lt;/code> generates three widgets, and uses functions written in the &lt;code>targets-extras.js&lt;/code> file.&lt;/p>
&lt;h3 id="targetsjs-1">&lt;code>targets.js&lt;/code>&lt;/h3>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-js" data-lang="js">&lt;span style="color:#204a87;font-weight:bold">const&lt;/span> &lt;span style="color:#000;font-weight:bold">{&lt;/span> &lt;span style="color:#000">isHealthyDelivery&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">countReportsSubmittedInWindow&lt;/span> &lt;span style="color:#000;font-weight:bold">}&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span> &lt;span style="color:#000">require&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#4e9a06">&amp;#39;./targets-extras&amp;#39;&lt;/span>&lt;span style="color:#000;font-weight:bold">);&lt;/span>
&lt;span style="color:#000">module&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">exports&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span> &lt;span style="color:#000;font-weight:bold">[&lt;/span>
&lt;span style="color:#8f5902;font-style:italic">// BIRTHS THIS MONTH
&lt;/span>&lt;span style="color:#8f5902;font-style:italic">&lt;/span> &lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;span style="color:#000">id&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span> &lt;span style="color:#4e9a06">&amp;#39;births-this-month&amp;#39;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;span style="color:#000">type&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span> &lt;span style="color:#4e9a06">&amp;#39;count&amp;#39;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;span style="color:#000">icon&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span> &lt;span style="color:#4e9a06">&amp;#39;infant&amp;#39;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;span style="color:#000">goal&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">-&lt;/span>&lt;span style="color:#0000cf;font-weight:bold">1&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;span style="color:#000">translation_key&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span> &lt;span style="color:#4e9a06">&amp;#39;targets.births.title&amp;#39;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;span style="color:#000">subtitle_translation_key&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span> &lt;span style="color:#4e9a06">&amp;#39;targets.this_month.subtitle&amp;#39;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;span style="color:#000">appliesTo&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span> &lt;span style="color:#4e9a06">&amp;#39;reports&amp;#39;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;span style="color:#000">appliesIf&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span> &lt;span style="color:#000">isHealthyDelivery&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;span style="color:#000">date&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span> &lt;span style="color:#4e9a06">&amp;#39;reported&amp;#39;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;span style="color:#000;font-weight:bold">},&lt;/span>
&lt;span style="color:#8f5902;font-style:italic">// % DELIVERIES ALL TIME WITH 1+ VISITS
&lt;/span>&lt;span style="color:#8f5902;font-style:italic">&lt;/span> &lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;span style="color:#000">id&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span> &lt;span style="color:#4e9a06">&amp;#39;delivery-with-min-1-visit&amp;#39;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;span style="color:#000">type&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span> &lt;span style="color:#4e9a06">&amp;#39;percent&amp;#39;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;span style="color:#000">icon&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span> &lt;span style="color:#4e9a06">&amp;#39;nurse&amp;#39;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;span style="color:#000">goal&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span> &lt;span style="color:#0000cf;font-weight:bold">100&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;span style="color:#000">translation_key&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span> &lt;span style="color:#4e9a06">&amp;#39;targets.delivery_1_visit.title&amp;#39;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;span style="color:#000">subtitle_translation_key&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span> &lt;span style="color:#4e9a06">&amp;#39;targets.all_time.subtitle&amp;#39;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;span style="color:#000">appliesTo&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span> &lt;span style="color:#4e9a06">&amp;#39;reports&amp;#39;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;span style="color:#000">idType&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span> &lt;span style="color:#4e9a06">&amp;#39;report&amp;#39;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;span style="color:#000">appliesIf&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span> &lt;span style="color:#000">isHealthyDelivery&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;span style="color:#000">passesIf&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span> &lt;span style="color:#204a87;font-weight:bold">function&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">c&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">r&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span> &lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;span style="color:#204a87;font-weight:bold">var&lt;/span> &lt;span style="color:#000">visits&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span> &lt;span style="color:#000">countReportsSubmittedInWindow&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">c&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">reports&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">antenatalForms&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">r&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">reported_date&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">-&lt;/span> &lt;span style="color:#000">MAX_DAYS_IN_PREGNANCY&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">*&lt;/span>&lt;span style="color:#000">MS_IN_DAY&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">r&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">reported_date&lt;/span>&lt;span style="color:#000;font-weight:bold">);&lt;/span>
&lt;span style="color:#204a87;font-weight:bold">return&lt;/span> &lt;span style="color:#000">visits&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">&amp;gt;&lt;/span> &lt;span style="color:#0000cf;font-weight:bold">0&lt;/span>&lt;span style="color:#000;font-weight:bold">;&lt;/span>
&lt;span style="color:#000;font-weight:bold">},&lt;/span>
&lt;span style="color:#000">date&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span> &lt;span style="color:#4e9a06">&amp;#39;now&amp;#39;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;span style="color:#000;font-weight:bold">},&lt;/span>
&lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;span style="color:#000">id&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span> &lt;span style="color:#4e9a06">&amp;#39;2-home-visits-per-family&amp;#39;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;span style="color:#000">icon&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span> &lt;span style="color:#4e9a06">&amp;#39;home-visit&amp;#39;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;span style="color:#000">type&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span> &lt;span style="color:#4e9a06">&amp;#39;percent&amp;#39;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;span style="color:#000">goal&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span> &lt;span style="color:#0000cf;font-weight:bold">100&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;span style="color:#000">translation_key&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span> &lt;span style="color:#4e9a06">`target.2-home-visits-per-family`&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;span style="color:#000">context&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span> &lt;span style="color:#4e9a06">&amp;#39;user.role === &amp;#34;chw&amp;#34;&amp;#39;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;span style="color:#000">date&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span> &lt;span style="color:#4e9a06">&amp;#39;reported&amp;#39;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;span style="color:#000">appliesTo&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span> &lt;span style="color:#4e9a06">&amp;#39;contacts&amp;#39;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;span style="color:#000">appliesToType&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span> &lt;span style="color:#4e9a06">&amp;#39;person&amp;#39;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;span style="color:#000">idType&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span> &lt;span style="color:#000">contact&lt;/span> &lt;span style="color:#000;font-weight:bold">=&amp;gt;&lt;/span> &lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;span style="color:#8f5902;font-style:italic">// Determines the target ids which will be in the group.
&lt;/span>&lt;span style="color:#8f5902;font-style:italic">&lt;/span> &lt;span style="color:#8f5902;font-style:italic">// eg. &amp;#34;family1~2000-02-15&amp;#34; and &amp;#34;family1~2000-02-16&amp;#34;
&lt;/span>&lt;span style="color:#8f5902;font-style:italic">&lt;/span> &lt;span style="color:#204a87;font-weight:bold">const&lt;/span> &lt;span style="color:#000">householdVisitDates&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span> &lt;span style="color:#204a87;font-weight:bold">new&lt;/span> &lt;span style="color:#000">Set&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">contact&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">reports&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">map&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">report&lt;/span> &lt;span style="color:#000;font-weight:bold">=&amp;gt;&lt;/span> &lt;span style="color:#000">toDateString&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">report&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">reported_date&lt;/span>&lt;span style="color:#000;font-weight:bold">)));&lt;/span>
&lt;span style="color:#204a87;font-weight:bold">const&lt;/span> &lt;span style="color:#000">familyId&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span> &lt;span style="color:#000">contact&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">contact&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">parent&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">_id&lt;/span>&lt;span style="color:#000;font-weight:bold">;&lt;/span>
&lt;span style="color:#204a87;font-weight:bold">return&lt;/span> &lt;span style="color:#204a87">Array&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">from&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">householdVisitDates&lt;/span>&lt;span style="color:#000;font-weight:bold">).&lt;/span>&lt;span style="color:#000">map&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">date&lt;/span> &lt;span style="color:#000;font-weight:bold">=&amp;gt;&lt;/span> &lt;span style="color:#4e9a06">`&lt;/span>&lt;span style="color:#4e9a06">${&lt;/span>&lt;span style="color:#000">familyId&lt;/span>&lt;span style="color:#4e9a06">}&lt;/span>&lt;span style="color:#4e9a06">~&lt;/span>&lt;span style="color:#4e9a06">${&lt;/span>&lt;span style="color:#000">date&lt;/span>&lt;span style="color:#4e9a06">}&lt;/span>&lt;span style="color:#4e9a06">`&lt;/span>&lt;span style="color:#000;font-weight:bold">);&lt;/span>
&lt;span style="color:#000;font-weight:bold">},&lt;/span>
&lt;span style="color:#000">groupBy&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span> &lt;span style="color:#000">contact&lt;/span> &lt;span style="color:#000;font-weight:bold">=&amp;gt;&lt;/span> &lt;span style="color:#000">contact&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">contact&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">parent&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">_id&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;span style="color:#000">passesIfGroupCount&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span> &lt;span style="color:#000;font-weight:bold">{&lt;/span> &lt;span style="color:#000">gte&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span> &lt;span style="color:#0000cf;font-weight:bold">2&lt;/span> &lt;span style="color:#000;font-weight:bold">},&lt;/span>
&lt;span style="color:#000;font-weight:bold">}&lt;/span>
&lt;span style="color:#000;font-weight:bold">]&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="targets-extrasjs">&lt;code>targets-extras.js&lt;/code>&lt;/h3>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-js" data-lang="js">&lt;span style="color:#000">module&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">exports&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span> &lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;span style="color:#000">isHealthyDelivery&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">c&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">r&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span> &lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;span style="color:#204a87;font-weight:bold">return&lt;/span> &lt;span style="color:#000">r&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">form&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">===&lt;/span> &lt;span style="color:#4e9a06">&amp;#39;D&amp;#39;&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">||&lt;/span>
&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">r&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">form&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">===&lt;/span> &lt;span style="color:#4e9a06">&amp;#39;delivery&amp;#39;&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">&amp;amp;&amp;amp;&lt;/span> &lt;span style="color:#000">r&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">fields&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">pregnancy_outcome&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">===&lt;/span> &lt;span style="color:#4e9a06">&amp;#39;healthy&amp;#39;&lt;/span>&lt;span style="color:#000;font-weight:bold">);&lt;/span>
&lt;span style="color:#000;font-weight:bold">},&lt;/span>
&lt;span style="color:#000">countReportsSubmittedInWindow&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">reports&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">form&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">start&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">end&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span> &lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;span style="color:#204a87;font-weight:bold">var&lt;/span> &lt;span style="color:#000">reportsFound&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span> &lt;span style="color:#0000cf;font-weight:bold">0&lt;/span>&lt;span style="color:#000;font-weight:bold">;&lt;/span>
&lt;span style="color:#000">reports&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">forEach&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#204a87;font-weight:bold">function&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">r&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span> &lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;span style="color:#204a87;font-weight:bold">if&lt;/span> &lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">form&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">indexOf&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">r&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">form&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">&amp;gt;=&lt;/span> &lt;span style="color:#0000cf;font-weight:bold">0&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span> &lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;span style="color:#204a87;font-weight:bold">if&lt;/span> &lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">r&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">reported_date&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">&amp;gt;=&lt;/span> &lt;span style="color:#000">start&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">&amp;amp;&amp;amp;&lt;/span> &lt;span style="color:#000">r&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">reported_date&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">&amp;lt;=&lt;/span> &lt;span style="color:#000">end&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span> &lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;span style="color:#000">reportsFound&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">++&lt;/span>&lt;span style="color:#000;font-weight:bold">;&lt;/span>
&lt;span style="color:#000;font-weight:bold">}&lt;/span>
&lt;span style="color:#000;font-weight:bold">}&lt;/span>
&lt;span style="color:#000;font-weight:bold">});&lt;/span>
&lt;span style="color:#204a87;font-weight:bold">return&lt;/span> &lt;span style="color:#000">reportsFound&lt;/span>&lt;span style="color:#000;font-weight:bold">;&lt;/span>
&lt;span style="color:#000;font-weight:bold">},&lt;/span>
&lt;span style="color:#000;font-weight:bold">};&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="build">Build&lt;/h2>
&lt;p>To build your targets into your app, you must compile them into app-settings, then upload them to your instance.&lt;/p>
&lt;p>&lt;code>medic-conf --local compile-app-settings backup-app-settings upload-app-settings&lt;/code>&lt;/p></description></item><item><title>Apps: tasks.js</title><link>https://docs.communityhealthtoolkit.org/beta/apps/reference/tasks/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://docs.communityhealthtoolkit.org/beta/apps/reference/tasks/</guid><description>
&lt;p>&lt;img src="task-with-description.png" alt="task">&lt;/p>
&lt;p>Tasks are configured in the &lt;code>tasks.js&lt;/code> file. This file is a JavaScript module which defines an array of objects conforming to the Task schema detailed below. When defining tasks, all the data about contacts on the device (both people and places) along with all their reports are available. Tasks are available only for users of type &amp;ldquo;restricted to their place&amp;rdquo;. Tasks can pull in fields from reports and pass data as inputs to the form that opens when the task is selected, enabling richer user experiences.&lt;/p>
&lt;p>&lt;em>See Also:&lt;/em> &lt;a href=https://docs.communityhealthtoolkit.org/beta/apps/features/tasks/#>Tasks Overview&lt;/a>&lt;/p>
&lt;h2 id="tasksjs">&lt;code>tasks.js&lt;/code>&lt;/h2>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>property&lt;/th>
&lt;th>type&lt;/th>
&lt;th>description&lt;/th>
&lt;th>required&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>&lt;code>name&lt;/code>&lt;/td>
&lt;td>&lt;code>string&lt;/code>&lt;/td>
&lt;td>A unique identifier for the task. Used for querying task completeness.&lt;/td>
&lt;td>yes, unique&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>icon&lt;/code>&lt;/td>
&lt;td>&lt;code>string&lt;/code>&lt;/td>
&lt;td>The icon to show alongside the task. Should correspond with a value defined in &lt;code>resources.json&lt;/code>.&lt;/td>
&lt;td>no&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>title&lt;/code>&lt;/td>
&lt;td>&lt;code>translation key&lt;/code>&lt;/td>
&lt;td>The title of the task (labeled above).&lt;/td>
&lt;td>yes&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>appliesTo&lt;/code>&lt;/td>
&lt;td>&lt;code>'contacts'&lt;/code> or &lt;code>'reports'&lt;/code>&lt;/td>
&lt;td>Do you want to emit one task per report, or one task per contact? This attribute controls the behavior of other properties herein.&lt;/td>
&lt;td>yes&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>appliesIf&lt;/code>&lt;/td>
&lt;td>&lt;code>function(contact, report)&lt;/code>&lt;/td>
&lt;td>If &lt;code>appliesTo: 'contacts'&lt;/code>, this function is invoked once per contact and &lt;code>report&lt;/code> is undefined. If &lt;code>appliesTo: 'reports'&lt;/code>, this function is invoked once per report. Return true if the task should appear for the given documents.&lt;/td>
&lt;td>no&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>appliesToType&lt;/code>&lt;/td>
&lt;td>&lt;code>string[]&lt;/code>&lt;/td>
&lt;td>Filters the contacts or reports for which &lt;code>appliesIf&lt;/code> will be evaluated. If &lt;code>appliesTo: 'reports'&lt;/code>, this is an array of form codes. If &lt;code>appliesTo: 'contacts'&lt;/code>, this is an array of contact types. For example, &lt;code>['person']&lt;/code> or &lt;code>['clinic', 'health_center']&lt;/code>. For example, &lt;code>['pregnancy']&lt;/code> or &lt;code>['P', 'pregnancy']&lt;/code>.&lt;/td>
&lt;td>no&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>contactLabel&lt;/code>&lt;/td>
&lt;td>&lt;code>string&lt;/code> or &lt;code>function(contact, report)&lt;/code>&lt;/td>
&lt;td>Controls the label describing the subject of the task. Defaults to the name of the contact (&lt;code>contact.contact.name&lt;/code>).&lt;/td>
&lt;td>no&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>resolvedIf&lt;/code>&lt;/td>
&lt;td>&lt;code>function(contact, report, event, dueDate)&lt;/code>&lt;/td>
&lt;td>Return true to mark the task as &amp;ldquo;resolved&amp;rdquo;. A resolved task uses memory on the phone, but is not displayed.&lt;/td>
&lt;td>yes&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>events&lt;/code>&lt;/td>
&lt;td>&lt;code>object[]&lt;/code>&lt;/td>
&lt;td>An event is used to specify the timing of the task.&lt;/td>
&lt;td>yes&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>events[n].id&lt;/code>&lt;/td>
&lt;td>&lt;code>string&lt;/code>&lt;/td>
&lt;td>A descriptive identifier. Used for querying task completeness.&lt;/td>
&lt;td>yes, unique&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>events[n].days&lt;/code>&lt;/td>
&lt;td>&lt;code>integer&lt;/code>&lt;/td>
&lt;td>Number of days after the doc&amp;rsquo;s &lt;code>reported_date&lt;/code> that the event is due&lt;/td>
&lt;td>yes, if &lt;code>dueDate&lt;/code> is not set&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>events[n].dueDate&lt;/code>&lt;/td>
&lt;td>&lt;code>function(event, contact, report)&lt;/code>&lt;/td>
&lt;td>Returns a &lt;code>Date&lt;/code> object for the day when this event is due.&lt;/td>
&lt;td>yes, if &lt;code>days&lt;/code> is not set&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>events[n].start&lt;/code>&lt;/td>
&lt;td>&lt;code>integer&lt;/code>&lt;/td>
&lt;td>Number of days to show the task before it is due.&lt;/td>
&lt;td>yes&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>events[n].end&lt;/code>&lt;/td>
&lt;td>&lt;code>integer&lt;/code>&lt;/td>
&lt;td>Number of days to show the task after it is due.&lt;/td>
&lt;td>yes&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>actions&lt;/code>&lt;/td>
&lt;td>&lt;code>object[]&lt;/code>&lt;/td>
&lt;td>The actions (forms) that a user can access after clicking on a task. If you put multiple forms here, the user will see a task summary screen where they can select which action they would like to complete.&lt;/td>
&lt;td>yes&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>actions[n].type&lt;/code>&lt;/td>
&lt;td>&lt;code>'report'&lt;/code> or &lt;code>'contact'&lt;/code>&lt;/td>
&lt;td>When &lt;code>'report'&lt;/code>, the action opens the given form. When &lt;code>'contact'&lt;/code>, the action redirects to a contact&amp;rsquo;s profile page. Defaults to &amp;lsquo;report&amp;rsquo;.&lt;/td>
&lt;td>no&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>actions[n].form&lt;/code>&lt;/td>
&lt;td>&lt;code>string&lt;/code>&lt;/td>
&lt;td>The code of the form that should open when you select the action.&lt;/td>
&lt;td>yes&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>actions[n].label&lt;/code>&lt;/td>
&lt;td>&lt;code>translation key&lt;/code>&lt;/td>
&lt;td>The label that should appear on the task summary screen if multiple actions are present.&lt;/td>
&lt;td>no&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>actions[n].modifyContent&lt;/code>&lt;/td>
&lt;td>&lt;code>function (content, contact, report)&lt;/code>&lt;/td>
&lt;td>Set the values on the content object to control the data which will be passed as &lt;code>inputs&lt;/code> to the form which opens when the action is selected.&lt;/td>
&lt;td>no&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>priority&lt;/code>&lt;/td>
&lt;td>&lt;code>object&lt;/code> or &lt;code>function(contact, report)&lt;/code> returning object of same schema&lt;/td>
&lt;td>Controls the &amp;ldquo;high risk&amp;rdquo; line seen above.&lt;/td>
&lt;td>no&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>priority.level&lt;/code>&lt;/td>
&lt;td>&lt;code>high&lt;/code> or &lt;code>medium&lt;/code>&lt;/td>
&lt;td>Tasks that are &lt;code>high&lt;/code> will display a high risk icon with the task. Default: &lt;code>medium&lt;/code>.&lt;/td>
&lt;td>no&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>priority.label&lt;/code>&lt;/td>
&lt;td>&lt;code>translation key&lt;/code>&lt;/td>
&lt;td>Text shown with the task associated to the risk level.&lt;/td>
&lt;td>no&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;h2 id="utils">Utils&lt;/h2>
&lt;p>Utility functions in the Core Framework can make common tasks much easier. These are available only for Tasks and Targets. To use the function call &lt;code>Utils.&amp;lt;function-name&amp;gt;(&amp;lt;params&amp;gt;)&lt;/code>, for example &lt;code>Utils.addDate(report.reported_date, 10)&lt;/code>.&lt;/p>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>Name&lt;/th>
&lt;th>Description&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>&lt;code>isTimely(date, event)&lt;/code>&lt;/td>
&lt;td>Returns true if the given date is after the start date and before the end date of the event.&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>addDate(date, days)&lt;/code>&lt;/td>
&lt;td>Returns a new Date set to midnight the given number of days after the given date. If no date is given the date defaults to today.&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>getLmpDate(doc)&lt;/code>&lt;/td>
&lt;td>Attempts to work out the LMP from the given doc. If no LMP is given it defaults to four weeks before the reported_date.&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>getSchedule(name)&lt;/code>&lt;/td>
&lt;td>Returns the task schedule with the given name from the configuration.&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>getMostRecentTimestamp(reports, form)&lt;/code>&lt;/td>
&lt;td>Returns the reported_date of the most recent of the reports with form ID matching the given form.&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>getMostRecentReport(reports, form)&lt;/code>&lt;/td>
&lt;td>Like &lt;code>getMostRecentTimestamp&lt;/code> but returns the report, not just the reported_date.&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>isFormSubmittedInWindow(reports, form, start, end)&lt;/code>&lt;/td>
&lt;td>Returns true if any of the given reports are for the given form and were reported after start and before end.&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>isFirstReportNewer(firstReport, secondReport)&lt;/code>&lt;/td>
&lt;td>Returns true if the firstReport was reported before the secondReport.&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>isDateValid(date)&lt;/code>&lt;/td>
&lt;td>Returns true if the given date is a validate JavaScript Date.&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>now()&lt;/code>&lt;/td>
&lt;td>Returns the current Date.&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>MS_IN_DAY&lt;/code>&lt;/td>
&lt;td>A constant for the number of milliseconds in a day.&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;p>Please open &lt;a href="https://github.com/medic/cht-core/issues/new">an issue&lt;/a> if you&amp;rsquo;d like other functions included.&lt;/p>
&lt;h2 id="nools-extras">Nools Extras&lt;/h2>
&lt;p>Helper variables and functions can be defined in &lt;code>nools-extras.js&lt;/code>, which is shared by both &lt;code>tasks.js&lt;/code> and &lt;code>targets.js&lt;/code>. The following are global variables that can be used:&lt;/p>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>Variable&lt;/th>
&lt;th>Description&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>&lt;code>c.contact&lt;/code>&lt;/td>
&lt;td>The contact&amp;rsquo;s doc. All contacts have &lt;code>type&lt;/code> of either &lt;code>person&lt;/code> or &lt;code>place&lt;/code>.&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>c.reports&lt;/code>&lt;/td>
&lt;td>An array of all the reports submitted about the contact.&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>console&lt;/code>&lt;/td>
&lt;td>Useful for outputting &lt;em>debugging&lt;/em> statements. Should not be used in production code.&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>Utils&lt;/code>&lt;/td>
&lt;td>Useful functions across projects are available, and describe in the Utils section.&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;h2 id="code-samples">Code samples&lt;/h2>
&lt;h3 id="basic-task">Basic task&lt;/h3>
&lt;p>This sample &lt;code>tasks.js&lt;/code> generates two postnatal-visit tasks for each delivery form. The tasks are due 7 and 14 days after the delivery report was submitted. Each task is displayed for 2 days before the due date and 2 days after the due date.&lt;/p>
&lt;h4 id="tasksjs-1">tasks.js&lt;/h4>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-js" data-lang="js">&lt;span style="color:#000">module&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">exports&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span> &lt;span style="color:#000;font-weight:bold">[&lt;/span>
&lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;span style="color:#000">icon&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span> &lt;span style="color:#4e9a06">&amp;#39;mother-child&amp;#39;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;span style="color:#000">title&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span> &lt;span style="color:#4e9a06">&amp;#39;task.postnatal_followup&amp;#39;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;span style="color:#000">appliesTo&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span> &lt;span style="color:#4e9a06">&amp;#39;reports&amp;#39;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;span style="color:#000">appliesToType&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span> &lt;span style="color:#000;font-weight:bold">[&lt;/span> &lt;span style="color:#4e9a06">&amp;#39;delivery&amp;#39;&lt;/span> &lt;span style="color:#000;font-weight:bold">],&lt;/span>
&lt;span style="color:#000">actions&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span> &lt;span style="color:#000;font-weight:bold">[&lt;/span> &lt;span style="color:#000;font-weight:bold">{&lt;/span> &lt;span style="color:#000">form&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span> &lt;span style="color:#4e9a06">&amp;#39;postnatal_visit&amp;#39;&lt;/span> &lt;span style="color:#000;font-weight:bold">}&lt;/span> &lt;span style="color:#000;font-weight:bold">],&lt;/span>
&lt;span style="color:#000">events&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span> &lt;span style="color:#000;font-weight:bold">[&lt;/span>
&lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;span style="color:#000">days&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span>&lt;span style="color:#0000cf;font-weight:bold">7&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">start&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span>&lt;span style="color:#0000cf;font-weight:bold">2&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">end&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span>&lt;span style="color:#0000cf;font-weight:bold">2&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;span style="color:#000;font-weight:bold">},&lt;/span>
&lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;span style="color:#000">days&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span>&lt;span style="color:#0000cf;font-weight:bold">14&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">start&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span>&lt;span style="color:#0000cf;font-weight:bold">2&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">end&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span>&lt;span style="color:#0000cf;font-weight:bold">2&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;span style="color:#000;font-weight:bold">}&lt;/span>
&lt;span style="color:#000;font-weight:bold">]&lt;/span>
&lt;span style="color:#000;font-weight:bold">}&lt;/span>
&lt;span style="color:#000;font-weight:bold">];&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="tasks-with-functions">Tasks with functions&lt;/h3>
&lt;p>These samples show more complex tasks which use functions kepts in a separate &lt;code>nools-extras.js&lt;/code> file&lt;/p>
&lt;h4 id="tasksjs-2">&lt;code>tasks.js&lt;/code>&lt;/h4>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-js" data-lang="js">&lt;span style="color:#204a87;font-weight:bold">const&lt;/span> &lt;span style="color:#000">extras&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span> &lt;span style="color:#000">require&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#4e9a06">&amp;#39;./nools-extras&amp;#39;&lt;/span>&lt;span style="color:#000;font-weight:bold">);&lt;/span>
&lt;span style="color:#204a87;font-weight:bold">const&lt;/span> &lt;span style="color:#000;font-weight:bold">{&lt;/span> &lt;span style="color:#000">isFormFromArraySubmittedInWindow&lt;/span> &lt;span style="color:#000;font-weight:bold">}&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span> &lt;span style="color:#000">extras&lt;/span>&lt;span style="color:#000;font-weight:bold">;&lt;/span>
&lt;span style="color:#000">module&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">exports&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span> &lt;span style="color:#000;font-weight:bold">[&lt;/span>
&lt;span style="color:#8f5902;font-style:italic">// PNC TASK 1: If a home delivery, needs clinic tasks
&lt;/span>&lt;span style="color:#8f5902;font-style:italic">&lt;/span> &lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;span style="color:#000">icon&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span> &lt;span style="color:#4e9a06">&amp;#39;mother-child&amp;#39;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;span style="color:#000">title&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span> &lt;span style="color:#000;font-weight:bold">[&lt;/span> &lt;span style="color:#000;font-weight:bold">{&lt;/span> &lt;span style="color:#000">locale&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span>&lt;span style="color:#4e9a06">&amp;#39;en&amp;#39;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">content&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span>&lt;span style="color:#4e9a06">&amp;#39;Postnatal visit needed&amp;#39;&lt;/span> &lt;span style="color:#000;font-weight:bold">}&lt;/span> &lt;span style="color:#000;font-weight:bold">],&lt;/span>
&lt;span style="color:#000">appliesTo&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span> &lt;span style="color:#4e9a06">&amp;#39;reports&amp;#39;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;span style="color:#000">appliesToType&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span> &lt;span style="color:#000;font-weight:bold">[&lt;/span> &lt;span style="color:#4e9a06">&amp;#39;D&amp;#39;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#4e9a06">&amp;#39;delivery&amp;#39;&lt;/span> &lt;span style="color:#000;font-weight:bold">],&lt;/span>
&lt;span style="color:#000">appliesIf&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span> &lt;span style="color:#204a87;font-weight:bold">function&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">c&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">r&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span> &lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;span style="color:#204a87;font-weight:bold">return&lt;/span> &lt;span style="color:#000">isCoveredByUseCase&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">c&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">contact&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#4e9a06">&amp;#39;pnc&amp;#39;&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">&amp;amp;&amp;amp;&lt;/span>
&lt;span style="color:#000">r&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">fields&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">&amp;amp;&amp;amp;&lt;/span>
&lt;span style="color:#000">r&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">fields&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">delivery_code&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">&amp;amp;&amp;amp;&lt;/span>
&lt;span style="color:#000">r&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">fields&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">delivery_code&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">toUpperCase&lt;/span>&lt;span style="color:#000;font-weight:bold">()&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">!==&lt;/span> &lt;span style="color:#4e9a06">&amp;#39;F&amp;#39;&lt;/span>&lt;span style="color:#000;font-weight:bold">;&lt;/span>
&lt;span style="color:#000;font-weight:bold">},&lt;/span>
&lt;span style="color:#000">actions&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span> &lt;span style="color:#000;font-weight:bold">[{&lt;/span>
&lt;span style="color:#000">form&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span>&lt;span style="color:#4e9a06">&amp;#39;postnatal_visit&amp;#39;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;span style="color:#8f5902;font-style:italic">// Pass content that will be used within the task form
&lt;/span>&lt;span style="color:#8f5902;font-style:italic">&lt;/span> &lt;span style="color:#000">modifyContent&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span> &lt;span style="color:#204a87;font-weight:bold">function&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">content&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">c&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">r&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span> &lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;span style="color:#000">content&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">delivery_place&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span> &lt;span style="color:#4e9a06">&amp;#39;home&amp;#39;&lt;/span>&lt;span style="color:#000;font-weight:bold">;&lt;/span>
&lt;span style="color:#000;font-weight:bold">}&lt;/span>
&lt;span style="color:#000;font-weight:bold">}],&lt;/span>
&lt;span style="color:#000">events&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span> &lt;span style="color:#000;font-weight:bold">[&lt;/span> &lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;span style="color:#000">days&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span>&lt;span style="color:#0000cf;font-weight:bold">0&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">start&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span>&lt;span style="color:#0000cf;font-weight:bold">0&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">end&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span>&lt;span style="color:#0000cf;font-weight:bold">4&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;span style="color:#000;font-weight:bold">}&lt;/span> &lt;span style="color:#000;font-weight:bold">],&lt;/span>
&lt;span style="color:#000">priority&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span> &lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;span style="color:#000">level&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span> &lt;span style="color:#4e9a06">&amp;#39;high&amp;#39;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;span style="color:#000">label&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span> &lt;span style="color:#000;font-weight:bold">[&lt;/span> &lt;span style="color:#000;font-weight:bold">{&lt;/span> &lt;span style="color:#000">locale&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span>&lt;span style="color:#4e9a06">&amp;#39;en&amp;#39;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">content&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span>&lt;span style="color:#4e9a06">&amp;#39;Home Birth&amp;#39;&lt;/span> &lt;span style="color:#000;font-weight:bold">}&lt;/span> &lt;span style="color:#000;font-weight:bold">],&lt;/span>
&lt;span style="color:#000;font-weight:bold">},&lt;/span>
&lt;span style="color:#000">resolvedIf&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span> &lt;span style="color:#204a87;font-weight:bold">function&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">c&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">r&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">event&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">dueDate&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span> &lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;span style="color:#8f5902;font-style:italic">// Resolved if there a visit report received in time window or a newer pregnancy
&lt;/span>&lt;span style="color:#8f5902;font-style:italic">&lt;/span> &lt;span style="color:#204a87;font-weight:bold">return&lt;/span> &lt;span style="color:#000">r&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">reported_date&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">&amp;lt;&lt;/span> &lt;span style="color:#000">extras&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">getNewestDeliveryTimestamp&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">c&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">||&lt;/span>
&lt;span style="color:#000">r&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">reported_date&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">&amp;lt;&lt;/span> &lt;span style="color:#000">extras&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">getNewestPregnancyTimestamp&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">c&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">||&lt;/span>
&lt;span style="color:#000">isFormFromArraySubmittedInWindow&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">c&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">reports&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">extras&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">postnatalForms&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;span style="color:#000">Utils&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">addDate&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">dueDate&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">-&lt;/span>&lt;span style="color:#000">event&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">start&lt;/span>&lt;span style="color:#000;font-weight:bold">).&lt;/span>&lt;span style="color:#000">getTime&lt;/span>&lt;span style="color:#000;font-weight:bold">(),&lt;/span>
&lt;span style="color:#000">Utils&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">addDate&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">dueDate&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">event&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">end&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">+&lt;/span>&lt;span style="color:#0000cf;font-weight:bold">1&lt;/span>&lt;span style="color:#000;font-weight:bold">).&lt;/span>&lt;span style="color:#000">getTime&lt;/span>&lt;span style="color:#000;font-weight:bold">());&lt;/span>
&lt;span style="color:#000;font-weight:bold">},&lt;/span>
&lt;span style="color:#000;font-weight:bold">},&lt;/span>
&lt;span style="color:#8f5902;font-style:italic">// Option 1a: Place-based task: Family survey when place is created, then every 6 months
&lt;/span>&lt;span style="color:#8f5902;font-style:italic">&lt;/span> &lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;span style="color:#000">icon&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span> &lt;span style="color:#4e9a06">&amp;#39;family&amp;#39;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;span style="color:#000">title&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span> &lt;span style="color:#4e9a06">&amp;#39;task.family_survey.title&amp;#39;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;span style="color:#000">appliesTo&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span> &lt;span style="color:#4e9a06">&amp;#39;contacts&amp;#39;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;span style="color:#000">appliesToType&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span> &lt;span style="color:#000;font-weight:bold">[&lt;/span> &lt;span style="color:#4e9a06">&amp;#39;clinic&amp;#39;&lt;/span> &lt;span style="color:#000;font-weight:bold">],&lt;/span>
&lt;span style="color:#000">actions&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span> &lt;span style="color:#000;font-weight:bold">[&lt;/span> &lt;span style="color:#000;font-weight:bold">{&lt;/span> &lt;span style="color:#000">form&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span>&lt;span style="color:#4e9a06">&amp;#39;family_survey&amp;#39;&lt;/span> &lt;span style="color:#000;font-weight:bold">}&lt;/span> &lt;span style="color:#000;font-weight:bold">],&lt;/span>
&lt;span style="color:#000">events&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span> &lt;span style="color:#000;font-weight:bold">[&lt;/span> &lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;span style="color:#000">id&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span> &lt;span style="color:#4e9a06">&amp;#39;family-survey&amp;#39;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;span style="color:#000">days&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span>&lt;span style="color:#0000cf;font-weight:bold">0&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">start&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span>&lt;span style="color:#0000cf;font-weight:bold">0&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">end&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span>&lt;span style="color:#0000cf;font-weight:bold">14&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;span style="color:#000;font-weight:bold">}&lt;/span> &lt;span style="color:#000;font-weight:bold">],&lt;/span>
&lt;span style="color:#000">resolvedIf&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span> &lt;span style="color:#204a87;font-weight:bold">function&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">c&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">r&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">event&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">dueDate&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span> &lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;span style="color:#8f5902;font-style:italic">// Resolved if there a family survey received in time window
&lt;/span>&lt;span style="color:#8f5902;font-style:italic">&lt;/span> &lt;span style="color:#204a87;font-weight:bold">return&lt;/span> &lt;span style="color:#000">isFormFromArraySubmittedInWindow&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">c&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">reports&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#4e9a06">&amp;#39;family_survey&amp;#39;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;span style="color:#000">Utils&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">addDate&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">dueDate&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">-&lt;/span>&lt;span style="color:#000">event&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">start&lt;/span>&lt;span style="color:#000;font-weight:bold">).&lt;/span>&lt;span style="color:#000">getTime&lt;/span>&lt;span style="color:#000;font-weight:bold">(),&lt;/span>
&lt;span style="color:#000">Utils&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">addDate&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">dueDate&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">event&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">end&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">+&lt;/span>&lt;span style="color:#0000cf;font-weight:bold">1&lt;/span>&lt;span style="color:#000;font-weight:bold">).&lt;/span>&lt;span style="color:#000">getTime&lt;/span>&lt;span style="color:#000;font-weight:bold">());&lt;/span>
&lt;span style="color:#000;font-weight:bold">},&lt;/span>
&lt;span style="color:#000;font-weight:bold">},&lt;/span>
&lt;span style="color:#8f5902;font-style:italic">// Regular check for infants
&lt;/span>&lt;span style="color:#8f5902;font-style:italic">&lt;/span> &lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;span style="color:#000">icon&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span> &lt;span style="color:#4e9a06">&amp;#39;infant&amp;#39;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;span style="color:#000">title&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span> &lt;span style="color:#4e9a06">&amp;#39;task.infant.title&amp;#39;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;span style="color:#000">appliesTo&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span> &lt;span style="color:#4e9a06">&amp;#39;contacts&amp;#39;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;span style="color:#000">appliesToType&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span> &lt;span style="color:#000;font-weight:bold">[&lt;/span> &lt;span style="color:#4e9a06">&amp;#39;person&amp;#39;&lt;/span> &lt;span style="color:#000;font-weight:bold">],&lt;/span>
&lt;span style="color:#000">actions&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span> &lt;span style="color:#000;font-weight:bold">[&lt;/span> &lt;span style="color:#000;font-weight:bold">{&lt;/span> &lt;span style="color:#000">form&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span>&lt;span style="color:#4e9a06">&amp;#39;infant_assessment&amp;#39;&lt;/span> &lt;span style="color:#000;font-weight:bold">}&lt;/span> &lt;span style="color:#000;font-weight:bold">],&lt;/span>
&lt;span style="color:#000">events&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span> &lt;span style="color:#000;font-weight:bold">[&lt;/span>
&lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;span style="color:#000">id&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span> &lt;span style="color:#4e9a06">&amp;#39;infant_asssessment-q1&amp;#39;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;span style="color:#000">days&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span>&lt;span style="color:#0000cf;font-weight:bold">91&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">start&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span>&lt;span style="color:#0000cf;font-weight:bold">7&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">end&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span>&lt;span style="color:#0000cf;font-weight:bold">14&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;span style="color:#000;font-weight:bold">},&lt;/span>
&lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;span style="color:#000">id&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span> &lt;span style="color:#4e9a06">&amp;#39;infant_asssessment-q2&amp;#39;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;span style="color:#000">days&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span>&lt;span style="color:#0000cf;font-weight:bold">182&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">start&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span>&lt;span style="color:#0000cf;font-weight:bold">7&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">end&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span>&lt;span style="color:#0000cf;font-weight:bold">14&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;span style="color:#000;font-weight:bold">},&lt;/span>
&lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;span style="color:#000">id&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span> &lt;span style="color:#4e9a06">&amp;#39;infant_asssessment-q3&amp;#39;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;span style="color:#000">days&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span>&lt;span style="color:#0000cf;font-weight:bold">273&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">start&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span>&lt;span style="color:#0000cf;font-weight:bold">7&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">end&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span>&lt;span style="color:#0000cf;font-weight:bold">14&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;span style="color:#000;font-weight:bold">},&lt;/span>
&lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;span style="color:#000">id&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span> &lt;span style="color:#4e9a06">&amp;#39;infant_asssessment-q4&amp;#39;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;span style="color:#000">days&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span>&lt;span style="color:#0000cf;font-weight:bold">365&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">start&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span>&lt;span style="color:#0000cf;font-weight:bold">7&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">end&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span>&lt;span style="color:#0000cf;font-weight:bold">14&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;span style="color:#000;font-weight:bold">}&lt;/span>
&lt;span style="color:#000;font-weight:bold">]&lt;/span>
&lt;span style="color:#000;font-weight:bold">},&lt;/span>
&lt;span style="color:#8f5902;font-style:italic">// Option 2: Place-based task: Family survey every 6 months
&lt;/span>&lt;span style="color:#8f5902;font-style:italic">&lt;/span> &lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;span style="color:#000">icon&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span> &lt;span style="color:#4e9a06">&amp;#39;family&amp;#39;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;span style="color:#000">title&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span> &lt;span style="color:#4e9a06">&amp;#39;task.family_survey.title&amp;#39;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;span style="color:#000">appliesTo&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span> &lt;span style="color:#4e9a06">&amp;#39;contacts&amp;#39;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;span style="color:#000">appliesToType&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span> &lt;span style="color:#000;font-weight:bold">[&lt;/span> &lt;span style="color:#4e9a06">&amp;#39;clinic&amp;#39;&lt;/span> &lt;span style="color:#000;font-weight:bold">],&lt;/span>
&lt;span style="color:#000">appliesIf&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span> &lt;span style="color:#000">extras&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">needsFamilySurvey&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#8f5902;font-style:italic">// function returns true if family doesn&amp;#39;t have survey in previous 6 months
&lt;/span>&lt;span style="color:#8f5902;font-style:italic">&lt;/span> &lt;span style="color:#000">actions&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span> &lt;span style="color:#000;font-weight:bold">[&lt;/span> &lt;span style="color:#000;font-weight:bold">{&lt;/span> &lt;span style="color:#000">form&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span>&lt;span style="color:#4e9a06">&amp;#39;family_survey&amp;#39;&lt;/span> &lt;span style="color:#000;font-weight:bold">}&lt;/span> &lt;span style="color:#000;font-weight:bold">],&lt;/span>
&lt;span style="color:#000">events&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span> &lt;span style="color:#000;font-weight:bold">[&lt;/span> &lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;span style="color:#000">id&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span> &lt;span style="color:#4e9a06">&amp;#39;family-survey&amp;#39;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;span style="color:#000">start&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span>&lt;span style="color:#0000cf;font-weight:bold">0&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">end&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span>&lt;span style="color:#0000cf;font-weight:bold">14&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;span style="color:#000">dueDate&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span> &lt;span style="color:#000">extras&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">getNextFamilySurveyDate&lt;/span> &lt;span style="color:#8f5902;font-style:italic">// function gets expected date of next family survey
&lt;/span>&lt;span style="color:#8f5902;font-style:italic">&lt;/span> &lt;span style="color:#000;font-weight:bold">}&lt;/span> &lt;span style="color:#000;font-weight:bold">],&lt;/span>
&lt;span style="color:#000">resolvedIf&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span> &lt;span style="color:#204a87;font-weight:bold">function&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">c&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">r&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">event&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">dueDate&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span> &lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;span style="color:#8f5902;font-style:italic">// Resolved if there a family survey received in time window
&lt;/span>&lt;span style="color:#8f5902;font-style:italic">&lt;/span> &lt;span style="color:#204a87;font-weight:bold">return&lt;/span> &lt;span style="color:#000">isFormFromArraySubmittedInWindow&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">c&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">reports&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#4e9a06">&amp;#39;family_survey&amp;#39;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;span style="color:#000">Utils&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">addDate&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">dueDate&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">-&lt;/span>&lt;span style="color:#000">event&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">start&lt;/span>&lt;span style="color:#000;font-weight:bold">).&lt;/span>&lt;span style="color:#000">getTime&lt;/span>&lt;span style="color:#000;font-weight:bold">(),&lt;/span>
&lt;span style="color:#000">Utils&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">addDate&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">dueDate&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">event&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">end&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">+&lt;/span>&lt;span style="color:#0000cf;font-weight:bold">1&lt;/span>&lt;span style="color:#000;font-weight:bold">).&lt;/span>&lt;span style="color:#000">getTime&lt;/span>&lt;span style="color:#000;font-weight:bold">());&lt;/span>
&lt;span style="color:#000;font-weight:bold">},&lt;/span>
&lt;span style="color:#000;font-weight:bold">},&lt;/span>
&lt;span style="color:#000;font-weight:bold">]&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;h4 id="nools-extrasjs">&lt;code>nools-extras.js&lt;/code>&lt;/h4>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-js" data-lang="js">&lt;span style="color:#000">module&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">exports&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span> &lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;span style="color:#000">isCoveredByUseCase&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span> &lt;span style="color:#204a87;font-weight:bold">function&lt;/span> &lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">contact&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">usecase&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span> &lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;span style="color:#8f5902;font-style:italic">// ...
&lt;/span>&lt;span style="color:#8f5902;font-style:italic">&lt;/span> &lt;span style="color:#000;font-weight:bold">},&lt;/span>
&lt;span style="color:#000">getNewestDeliveryTimestamp&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span> &lt;span style="color:#204a87;font-weight:bold">function&lt;/span> &lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">c&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span> &lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;span style="color:#8f5902;font-style:italic">// ...
&lt;/span>&lt;span style="color:#8f5902;font-style:italic">&lt;/span> &lt;span style="color:#000;font-weight:bold">},&lt;/span>
&lt;span style="color:#000">getNewestPregnancyTimestamp&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span> &lt;span style="color:#204a87;font-weight:bold">function&lt;/span> &lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">c&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span> &lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;span style="color:#8f5902;font-style:italic">// ...
&lt;/span>&lt;span style="color:#8f5902;font-style:italic">&lt;/span> &lt;span style="color:#000;font-weight:bold">},&lt;/span>
&lt;span style="color:#000">isFormFromArraySubmittedInWindow&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span> &lt;span style="color:#204a87;font-weight:bold">function&lt;/span> &lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">reports&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">formsArray&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">startTime&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">endTime&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span> &lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;span style="color:#8f5902;font-style:italic">// ...
&lt;/span>&lt;span style="color:#8f5902;font-style:italic">&lt;/span> &lt;span style="color:#000;font-weight:bold">},&lt;/span>
&lt;span style="color:#000;font-weight:bold">};&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="build">Build&lt;/h2>
&lt;p>To build your tasks into your app, you must compile them into app-settings, then upload them to your instance.&lt;/p>
&lt;p>&lt;code>medic-conf --local compile-app-settings backup-app-settings upload-app-settings&lt;/code>&lt;/p></description></item><item><title>Apps:</title><link>https://docs.communityhealthtoolkit.org/beta/apps/reference/_partial_functions/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://docs.communityhealthtoolkit.org/beta/apps/reference/_partial_functions/</guid><description>
&lt;h2 id="utils">Utils&lt;/h2>
&lt;p>Utility functions in the Core Framework can make common tasks much easier. These are available only for Tasks and Targets. To use the function call &lt;code>Utils.&amp;lt;function-name&amp;gt;(&amp;lt;params&amp;gt;)&lt;/code>, for example &lt;code>Utils.addDate(report.reported_date, 10)&lt;/code>.&lt;/p>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>Name&lt;/th>
&lt;th>Description&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>&lt;code>isTimely(date, event)&lt;/code>&lt;/td>
&lt;td>Returns true if the given date is after the start date and before the end date of the event.&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>addDate(date, days)&lt;/code>&lt;/td>
&lt;td>Returns a new Date set to midnight the given number of days after the given date. If no date is given the date defaults to today.&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>getLmpDate(doc)&lt;/code>&lt;/td>
&lt;td>Attempts to work out the LMP from the given doc. If no LMP is given it defaults to four weeks before the reported_date.&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>getSchedule(name)&lt;/code>&lt;/td>
&lt;td>Returns the task schedule with the given name from the configuration.&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>getMostRecentTimestamp(reports, form)&lt;/code>&lt;/td>
&lt;td>Returns the reported_date of the most recent of the reports with form ID matching the given form.&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>getMostRecentReport(reports, form)&lt;/code>&lt;/td>
&lt;td>Like &lt;code>getMostRecentTimestamp&lt;/code> but returns the report, not just the reported_date.&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>isFormSubmittedInWindow(reports, form, start, end)&lt;/code>&lt;/td>
&lt;td>Returns true if any of the given reports are for the given form and were reported after start and before end.&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>isFirstReportNewer(firstReport, secondReport)&lt;/code>&lt;/td>
&lt;td>Returns true if the firstReport was reported before the secondReport.&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>isDateValid(date)&lt;/code>&lt;/td>
&lt;td>Returns true if the given date is a validate JavaScript Date.&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>now()&lt;/code>&lt;/td>
&lt;td>Returns the current Date.&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>MS_IN_DAY&lt;/code>&lt;/td>
&lt;td>A constant for the number of milliseconds in a day.&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;p>Please open &lt;a href="https://github.com/medic/cht-core/issues/new">an issue&lt;/a> if you&amp;rsquo;d like other functions included.&lt;/p>
&lt;h2 id="nools-extras">Nools Extras&lt;/h2>
&lt;p>Helper variables and functions can be defined in &lt;code>nools-extras.js&lt;/code>, which is shared by both &lt;code>tasks.js&lt;/code> and &lt;code>targets.js&lt;/code>. The following are global variables that can be used:&lt;/p>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>Variable&lt;/th>
&lt;th>Description&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>&lt;code>c.contact&lt;/code>&lt;/td>
&lt;td>The contact&amp;rsquo;s doc. All contacts have &lt;code>type&lt;/code> of either &lt;code>person&lt;/code> or &lt;code>place&lt;/code>.&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>c.reports&lt;/code>&lt;/td>
&lt;td>An array of all the reports submitted about the contact.&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>console&lt;/code>&lt;/td>
&lt;td>Useful for outputting &lt;em>debugging&lt;/em> statements. Should not be used in production code.&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>Utils&lt;/code>&lt;/td>
&lt;td>Useful functions across projects are available, and describe in the Utils section.&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table></description></item></channel></rss>